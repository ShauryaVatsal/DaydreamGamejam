(self.modernJsonp=self.modernJsonp||[]).push([["48137"],{17314:function(e,a,t){t.d(a,{Z:()=>d});var n,i,l=t(813653),r=t(831423),s=0,o=0;let d=function(e,a,t){var d=a&&t||0,u=a||Array(16),c=(e=e||{}).node||n,p=void 0!==e.clockseq?e.clockseq:i;if(null==c||null==p){var g=e.random||(e.rng||l.Z)();null==c&&(c=n=[1|g[0],g[1],g[2],g[3],g[4],g[5]]),null==p&&(p=i=(g[6]<<8|g[7])&16383)}var m=void 0!==e.msecs?e.msecs:Date.now(),h=void 0!==e.nsecs?e.nsecs:o+1,y=m-s+(h-o)/1e4;if(y<0&&void 0===e.clockseq&&(p=p+1&16383),(y<0||m>s)&&void 0===e.nsecs&&(h=0),h>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");s=m,o=h,i=p;var f=((0xfffffff&(m+=122192928e5))*1e4+h)%0x100000000;u[d++]=f>>>24&255,u[d++]=f>>>16&255,u[d++]=f>>>8&255,u[d++]=255&f;var _=m/0x100000000*1e4&0xfffffff;u[d++]=_>>>8&255,u[d++]=255&_,u[d++]=_>>>24&15|16,u[d++]=_>>>16&255,u[d++]=p>>>8|128,u[d++]=255&p;for(var x=0;x<6;++x)u[d+x]=c[x];return a||(0,r.Z)(u)}},135885:function(e,a,t){var n;t.r(a),t.d(a,{default:()=>l});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"BestPinCardAttribution_pin",selections:[{alias:null,args:null,concreteType:"Board",kind:"LinkedField",name:"board",plural:!1,selections:[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"privacy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSmallUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};i.hash="610a35d46510240eb58e262c1909310c";let l=i},5375:function(e,a,t){var n,i,l;t.r(a),t.d(a,{default:()=>s});let r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"BestPinCardBody_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"lastRepinDate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"ArticleMetadata",kind:"LinkedField",name:"article",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"datePublished",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,concreteType:"RecipeMetadata",kind:"LinkedField",name:"recipe",plural:!1,selections:[i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"CategorizedIngredientsMetadata",kind:"LinkedField",name:"categorizedIngredients",plural:!0,selections:[l={alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},{alias:null,args:null,concreteType:"ParsedIngredientMetadata",kind:"LinkedField",name:"ingredients",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"amt",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fromAggregatedData",storageKey:null},{args:null,kind:"FragmentSpread",name:"RecipeMetadata_recipe"}],storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"nativeCreator",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null}],storageKey:null},n,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinMetadataField",kind:"LinkedField",name:"metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"pinTitle",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PinJoin",kind:"LinkedField",name:"pinJoin",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"visualAnnotation",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},l,{args:null,kind:"FragmentSpread",name:"usePinImageUrls_pin"},{args:null,kind:"FragmentSpread",name:"useNormalizePinData_pin"},{args:null,kind:"FragmentSpread",name:"BestPinCardAttribution_pin"}],type:"Pin",abstractKey:null};r.hash="81db65fd15680cc0281b801ed4a8cb94";let s=r},716125:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CutoutObject_pin",selections:[{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"}],type:"Pin",abstractKey:null};n.hash="f1b62436c05814e4188c8863a11dce6b";let i=n},431225:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CutoutObjects_pin",selections:[{args:null,kind:"FragmentSpread",name:"CutoutObject_pin"},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"}],type:"Pin",abstractKey:null};n.hash="d2b8de09e9a0bd76025dff9de4c764e8";let i=n},500698:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"Descriptors_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null}],type:"Pin",abstractKey:null};n.hash="9d15639e8d9dd61426917dc218fbb3a6";let i=n},212480:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"OneBar_oneBarModules",selections:[{alias:"entityId",args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"OneBarModule_oneBarModules"}],type:"OneBarModule",abstractKey:null};n.hash="45cea1099e24f55ebce4abebdb411447";let i=n},815025:function(e,a,t){var n;t.r(a),t.d(a,{default:()=>l});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RecipeMetadata_recipe",selections:[{alias:null,args:null,concreteType:"AggregateRatingMetadata",kind:"LinkedField",name:"aggregateRating",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"bestRating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ratingValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reviewCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTimes",kind:"LinkedField",name:"cookTimes",plural:!1,selections:[{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"cook",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"m",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"prep",plural:!1,selections:n,storageKey:null}],storageKey:null}],type:"RecipeMetadata",abstractKey:null};i.hash="12f77507a9fdec344b44b7e659fa5ac1";let l=i},984110:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsImageContent_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{args:null,kind:"FragmentSpread",name:"Descriptors_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchCropper_pin"}],type:"Pin",abstractKey:null};n.hash="727c8ab2c1c256e3b4478a36890f92d6";let i=n},55575:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={fragment:{argumentDefinitions:l=[{defaultValue:null,kind:"LocalArgument",name:"pinId"}],kind:"Fragment",metadata:null,name:"RelatedProductsPageQuery",selections:[{alias:null,args:r=[{kind:"Variable",name:"pin",variableName:"pinId"}],concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[s={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[s,{args:null,kind:"FragmentSpread",name:"RelatedProductsPage_pin"}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"RelatedProductsPageQuery",selections:[{alias:null,args:r,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:"imageSpec_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:o=[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"564x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:o,storageKey:'images(spec:"736x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:o,storageKey:'images(spec:"orig")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:o,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:o,storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}]},params:{id:"b86d7fcbfae2ed1a4a0326984d0ac06dd58ba97fdf2909abe25d0d155a6703e6",metadata:{},name:"RelatedProductsPageQuery",operationKind:"query",text:null}};n.hash="0f7b98a1f02dbf8528df0452aa26efd4";let i=n;var l,r,s,o,d=n.default||n;if("query"===d.params.operationKind)if(window.__pwsCacheRelayConcreteRequest)window.__pwsCacheRelayConcreteRequest(d);else{let e=[d.params.name,d.params.id].join(":");window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__=window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__||{},window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__[e]=d}},376985:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsPage_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchPageWithPinData_pin"}],type:"Pin",abstractKey:null};n.hash="91d05676e413b7b47653c2f8fa609093";let i=n},758809:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsUnifiedFeed_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchMasonryGrid_pin"}],type:"Pin",abstractKey:null};n.hash="20c2c7f4ff982fb93a9608faa14f3ed2";let i=n},582328:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StelaCutouts_pin",selections:[{args:null,kind:"FragmentSpread",name:"StelaCutout_pin"},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"}],type:"Pin",abstractKey:null};n.hash="2d79886cca650301394af9cbacdeede4";let i=n},584411:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthCropperContainer_pin",selections:[{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"FlashlightSpotlightDots_pin"}],type:"Pin",abstractKey:null};n.hash="939d46d8644385a7918ed8179ce77a4c";let i=n},165135:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n=(l=[{defaultValue:null,kind:"LocalArgument",name:"pinId"}],r=[{kind:"Variable",name:"pin",variableName:"pinId"}],s={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},u=[{kind:"Literal",name:"spec",value:"564x"}],m=[{kind:"Literal",name:"spec",value:"736x"}],h=[g={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],y=[{kind:"Literal",name:"spec",value:"474x"}],f=[{kind:"Literal",name:"spec",value:"236x"}],_={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},v=[{alias:null,args:null,kind:"ScalarField",name:"m",storageKey:null}],w={alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:S=[s],storageKey:null},b={alias:"image236x",args:f,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:S,storageKey:'additionalImagesPerSpec(spec:"236x")'},k={alias:"image474x",args:y,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:S,storageKey:'additionalImagesPerSpec(spec:"474x")'},P={alias:"image564x",args:u,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:S,storageKey:'additionalImagesPerSpec(spec:"564x")'},F={alias:"image736x",args:m,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:S,storageKey:'additionalImagesPerSpec(spec:"736x")'},C={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},T=[p],{fragment:{argumentDefinitions:l,kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPageFetchDataPinQuery",selections:[{alias:null,args:r,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"UnauthDesktopFlashlightPageFetchData_pin"}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"UnauthDesktopFlashlightPageFetchDataPinQuery",selections:[{alias:null,args:r,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},o,{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},d],storageKey:null},{alias:"imageSpec_564x",args:u,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[c,p,g],storageKey:'images(spec:"564x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[c,p,g,s],storageKey:'images(spec:"orig")'},{alias:"imageSpec_736x",args:m,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"736x")'},{alias:"imageSpec_474x",args:y,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:f,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"lastRepinDate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"ArticleMetadata",kind:"LinkedField",name:"article",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"datePublished",storageKey:null}],storageKey:null},o,d,{alias:null,args:null,concreteType:"RecipeMetadata",kind:"LinkedField",name:"recipe",plural:!1,selections:[_,{alias:null,args:null,concreteType:"CategorizedIngredientsMetadata",kind:"LinkedField",name:"categorizedIngredients",plural:!0,selections:[x,{alias:null,args:null,concreteType:"ParsedIngredientMetadata",kind:"LinkedField",name:"ingredients",plural:!0,selections:[_,{alias:null,args:null,kind:"ScalarField",name:"amt",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fromAggregatedData",storageKey:null},{alias:null,args:null,concreteType:"AggregateRatingMetadata",kind:"LinkedField",name:"aggregateRating",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"bestRating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ratingValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reviewCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTimes",kind:"LinkedField",name:"cookTimes",plural:!1,selections:[{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"cook",plural:!1,selections:v,storageKey:null},{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"prep",plural:!1,selections:v,storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[s,_,w,{alias:null,args:null,concreteType:"Brand",kind:"LinkedField",name:"brand",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"signature",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ShippingInfo",kind:"LinkedField",name:"shippingInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"freeShippingPrice",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"freeShippingValue",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductVariantSet",kind:"LinkedField",name:"variantSet",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionMetadata",kind:"LinkedField",name:"dimensionMetadata",plural:!0,selections:[_,{alias:null,args:null,kind:"ScalarField",name:"values",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductVariant",kind:"LinkedField",name:"variants",plural:!0,selections:S,storageKey:null}],storageKey:null},b,k,P,F],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[_,w,{alias:null,args:null,kind:"ScalarField",name:"itemId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"itemSetId",storageKey:null},b,k,P,F],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"nativeCreator",plural:!1,selections:[C,R,j],storageKey:null},d,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinMetadataField",kind:"LinkedField",name:"metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"pinTitle",storageKey:null}],storageKey:null},j,s],storageKey:null},{alias:null,args:null,concreteType:"PinJoin",kind:"LinkedField",name:"pinJoin",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"visualAnnotation",storageKey:null}],storageKey:null},I,{alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},x,{alias:"imageSpec_60x60",args:[{kind:"Literal",name:"spec",value:"60x60"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:T,storageKey:'images(spec:"60x60")'},{alias:"imageSpec_136x136",args:[{kind:"Literal",name:"spec",value:"136x136"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:T,storageKey:'images(spec:"136x136")'},{alias:"imageSpec_170x",args:[{kind:"Literal",name:"spec",value:"170x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:T,storageKey:'images(spec:"170x")'},{alias:"imageSpec_600x315",args:[{kind:"Literal",name:"spec",value:"600x315"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:T,storageKey:'images(spec:"600x315")'},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null},{alias:null,args:null,concreteType:"Board",kind:"LinkedField",name:"board",plural:!1,selections:[I,_,{alias:null,args:null,kind:"ScalarField",name:"privacy",storageKey:null},p,j],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:[I,R,{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSmallUrl",storageKey:null},C,j],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForPdp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isOosProduct",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isStaleProduct",storageKey:null},{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,concreteType:"PinCarouselSlot",kind:"LinkedField",name:"carouselSlots",plural:!0,selections:S,storageKey:null},j],storageKey:null},{alias:null,args:null,concreteType:"ProductMetadataV2",kind:"LinkedField",name:"productPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"ItemMetadata",kind:"LinkedField",name:"items",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"additionalImagesLength",storageKey:null}],storageKey:null},j],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shoppingFlags",storageKey:null},{alias:null,args:null,concreteType:"AggregatedPinData",kind:"LinkedField",name:"aggregatedPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isShopTheLook",storageKey:null},j],storageKey:null},j],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}]},params:{id:"4f98fda893ba1980532b9905b28f196e419e75b106a6485f5f63653917b888e1",metadata:{},name:"UnauthDesktopFlashlightPageFetchDataPinQuery",operationKind:"query",text:null}});n.hash="c1c702b23a1454b46f8e2fa9d8036257";let i=n;var l,r,s,o,d,u,c,p,g,m,h,y,f,_,x,v,S,w,b,k,P,F,C,R,j,I,T,E=n.default||n;if("query"===E.params.operationKind)if(window.__pwsCacheRelayConcreteRequest)window.__pwsCacheRelayConcreteRequest(E);else{let e=[E.params.name,E.params.id].join(":");window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__=window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__||{},window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__[e]=E}},514336:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPageFetchData_pin",selections:[{args:null,kind:"FragmentSpread",name:"UnauthDesktopFlashlightPage_pin"}],type:"Pin",abstractKey:null};n.hash="01839fc3bcd9cdaf206873364167d157";let i=n},579652:function(e,a,t){var n;t.r(a),t.d(a,{default:()=>l});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPage_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null}],storageKey:null},{alias:"imageSpec_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null}],storageKey:'images(spec:"564x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"orig")'},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"BestPinCardBody_pin"},{args:null,kind:"FragmentSpread",name:"UnauthCropperContainer_pin"}],type:"Pin",abstractKey:null};i.hash="93612431e09eadc717c32d98e8d91e06";let l=i},172359:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchCarousel_story",selections:[{alias:null,args:null,concreteType:"StoryAction",kind:"LinkedField",name:"action",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"objects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:"storyId",args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyType",storageKey:null},{args:null,kind:"FragmentSpread",name:"CSSCarouselModule_story"}],type:"Story",abstractKey:null};n.hash="f426019c8f8e2668ff17a413d85a72dd";let i=n},829187:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchContainer_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"RelatedProductsImageContent_pin"},{args:null,kind:"FragmentSpread",name:"RelatedProductsUnifiedFeed_pin"}],type:"Pin",abstractKey:null};n.hash="3a9a747c3135f426fe0cf32ca9147a5d";let i=n},934209:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchCropper_pin",selections:[{args:null,kind:"FragmentSpread",name:"useSamSegmentation_pin"},{args:null,kind:"FragmentSpread",name:"StelaCutouts_pin"},{args:null,kind:"FragmentSpread",name:"CutoutObjects_pin"}],type:"Pin",abstractKey:null};n.hash="66496d579d49595f2dec36d1c939738c";let i=n},922081:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchImageContainer_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchCropper_pin"},{args:null,kind:"FragmentSpread",name:"Descriptors_pin"}],type:"Pin",abstractKey:null};n.hash="355940c4e98c8536ca89baf5b758fce5";let i=n},331921:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchLayout_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchImageContainer_pin"}],type:"Pin",abstractKey:null};n.hash="3c3f391c3bf9eec79c18ed9a3fe63800";let i=n},553593:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchPageWithPinData_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchContainer_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchLayout_pin"}],type:"Pin",abstractKey:null};n.hash="a97627ca011ed4139267bc5a970d6d7a";let i=n},799956:function(e,a,t){var n;t.r(a),t.d(a,{default:()=>l});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useNormalizePinData_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"orig")'},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:n=[{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:n,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null}],type:"Pin",abstractKey:null};i.hash="01a93671cde480baa2cfd8b781589acd";let l=i},160187:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useSamSegmentation_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],type:"Pin",abstractKey:null};n.hash="50c726067ab8af873ed4afded90b7bed";let i=n},742235:function(e,a,t){t.r(a),t.d(a,{default:()=>v});var n,i=t(281098),l=t(667294),r=t(167912),s=t(825332),o=t(20256),d=t(618140),u=t(29313),c=t(748130),p=t(289032),g=t(19585),m=t(816358),h=t(809295),y=t(15667),f=t(271910),_=t(785893);let x=(void 0!==n||(n=t(212480)).hash&&"45cea1099e24f55ebce4abebdb411447"!==n.hash&&console.error("The definition of 'OneBar_oneBarModules' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function v({center:e=!1,hasProductFiltersApplied:a,hrefOverride:t,itemHeight:n=d.Lu,marginBottom:v=d.JC,oneBarModulesKey:S,oneBarModulesRest:w,onFilterButtonClick:b,paddingBottom:k=d.uS,paddingX:P=d.jf,variant:F,viewParameter:C,viewType:R}){(0,l.useEffect)(()=>{(0,i.Z)("OneBar","/app/common/react/components/OneBar/OneBar.tsx")},[]);let j=(0,l.useRef)(null),I=j.current?.firstElementChild?.firstElementChild?.firstElementChild,[T,E]=(0,l.useState)(0),[Z,M]=(0,l.useState)(0),[D,K]=(0,l.useState)(!1),[L,A]=(0,l.useState)(!1),[$,O]=(0,l.useState)(0),B=(0,s.TH)(),N=(0,g.ZP)(),{isRTL:z}=(0,y.B)(),U=(0,l.useRef)(!1),W=new h.ZP,V=(0,r.useFragment)(x,S),G=V&&[V]||w,H=e&&(I?.clientWidth||0)>=(I?.scrollWidth||0);(0,l.useEffect)(()=>{let e=e=>{"Tab"===e.key&&(U.current=!1)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]),(0,l.useEffect)(()=>{E(0)},[B]),(0,l.useEffect)(()=>{M(I?.clientWidth||0);let e=(0,p.Z)(()=>{M(I?.clientWidth||0)},100,{maxWait:200});return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[I]),(0,l.useEffect)(()=>{let e=j.current;return e&&m.Z.addObstruction("top",e),()=>{e&&m.Z.removeObstruction("top",e)}}),(0,l.useEffect)(()=>{let e=I?.scrollWidth||0,a=0;for(let e=0;e<T;e+=1)a+=I?.children[e]?.offsetWidth||0;let t=e-a,n=Z>=e;n&&E(0),K(T>0&&!n),A(t>Z&&T<G.length&&!n),O(a)},[I,T,G.length,Z,$,z]);let Y=()=>{T+3<G.length?E(T+3):E(G.length-1)},X=()=>{T-3>=0?E(T-3):E(0)},q=(0,l.useRef)(null),{isFiltersDrawerFocused:Q}=(0,u.e)()||{isFiltersDrawerFocused:!1},[J,ee]=(0,l.useState)(Q);return(0,l.useEffect)(()=>{!Q&&J&&q.current?.focus(),ee(Q)},[Q,J]),G.length>0&&(0,_.jsx)(f.q,{children:({hovered:e,onMouseEnter:i,onMouseLeave:l})=>(0,_.jsxs)(o.xu,{ref:j,color:"default",dangerouslySetInlineStyle:{__style:{paddingBottom:k}},"data-root-margin":"search-one-bar","data-test-id":"scrollable-one-bar-root",marginBottom:v,onMouseEnter:i,onMouseLeave:l,position:"relative",children:[(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{overflowX:"clip"}},paddingX:P,position:"relative",children:(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{[z?"right":"left"]:`-${$}px`,transition:"left 0.3s, right 0.3s"}},position:"relative",children:(0,_.jsx)(o.kC,{alignItems:"center",gap:{row:2,column:0},height:n,justifyContent:H?"center":void 0,children:G.map((e,n)=>(0,_.jsx)(o.xu,{ref:1===n?q:void 0,onFocus:()=>{U.current||E(n)},onMouseDown:()=>U.current=!0,tabIndex:1===n?-1:void 0,children:(0,_.jsx)(c.Z,{hasProductFiltersApplied:a,hrefOverride:t,impressionsFramework:W,index:n,module:e,oneBarModulesKey:V??null,onFilterButtonClick:b,variant:F,viewParameter:C,viewType:R})},`OneBarModule-${e.entityId||e.id||""}`))})})}),e&&(0,_.jsxs)(o.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{background:(0,d.KC)(z,D,L),paddingBottom:d.uS,paddingLeft:d.EA,paddingRight:d.EA,pointerEvents:"none"}},"data-test-id":"one-bar-navigation-arrows",display:"flex",justifyContent:"between",left:!0,position:"absolute",right:!0,top:!0,children:[(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},children:D&&(0,_.jsx)(o.hU,{accessibilityLabel:N._('Back', 'oneBar.navArrow.back', 'Accessibility laber for a button that navigates back to previous search guides'),bgColor:"white",icon:"arrow-back",onClick:X})}),(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},children:L&&(0,_.jsx)(o.hU,{accessibilityLabel:N._('Forward', 'oneBar.navArrow.forward', 'Accessibility laber for a button that navigates forward to see more search guides'),bgColor:"white",icon:"arrow-forward",onClick:Y})})]})]})})}},699473:function(e,a,t){t.d(a,{Z:()=>l});var n=t(450808);let i=`pulsing {
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
}`,l={css:(0,n.Ll)([i]),animation:"pulsing 2s infinite"}},937805:function(e,a,t){t.d(a,{Z:()=>r});var n=t(675973),i=t(15667),l=t(647709);function r(){let{isAuthenticated:e}=(0,i.B)(),a=(0,l.ml)(),{checkExperiment:t}=(0,n.Z)();return{mWebCloseupRedesignEnabled:e&&a&&t("mweb_closeup_redesign").anyEnabled,mWebCloseupRedesignExpGroup:t("mweb_closeup_redesign").group}}},241646:function(e,a,t){t.d(a,{n:()=>n});let n=20},583270:function(e,a,t){t.d(a,{Z:()=>i});var n=t(378888);function i(e,a,t){let i=(0,n.mB)(e.search),l=parseFloat(i.x??""),r=parseFloat(i.y??""),s=parseFloat(i.w??""),o=parseFloat(i.h??"");if(function(...e){return e.every(e=>e>=0&&e<=1)}(l,r,s,o)&&a&&t)return{x:Math.floor(l*a),y:Math.floor(r*t),w:Math.floor(s*a),h:Math.floor(o*t)};{let e=parseInt(i.x??"",10),a=parseInt(i.y??"",10),t=parseInt(i.w??"",10),n=parseInt(i.h??"",10);return!function(...e){return e.every(Number.isInteger)}(e,a,t,n)?null:{x:e,y:a,w:t,h:n}}}},351222:function(e,a,t){t.d(a,{Pw:()=>n,SB:()=>i,ZP:()=>r,x9:()=>l});let n=80,i=55,l=e=>"phone"===e?i:n;function r(e,a){return a?0:l(e)}},166379:function(e,a,t){t.d(a,{Z:()=>l,k:()=>n.kH});var n=t(654937),i=t(15667);let l=({dateFormatType:e,useUTC:a=!0,value:t})=>{let l=(0,i.B)();return(0,n.ZP)(l.locale,t,e,a)}},469167:function(e,a,t){t.r(a),t.d(a,{default:()=>T});var n=t(281098),i=t(667294),l=t(20256),r=t(748065),s=t(980787),o=t(722194);function d(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}let u={},c=e=>{let a=e.__id||e.id;return"string"==typeof a&&a||null};class p{constructor(){d(this,"idMap",new Map),d(this,"objMap",new WeakMap)}get(e){let a=c(e);return this.objMap.get(e)??(a?this.idMap.get(a):void 0)}has(e){let a=c(e);return this.objMap.has(e)??(!!a&&this.idMap.has(a))}set(e,a){let t=c(e);t&&this.idMap.set(t,a),this.objMap.set(e,a)}reset(){this.idMap=new Map,this.objMap=new WeakMap}}function g(e,a){return"number"==typeof e?e:"lg1"===a?e[a]??e.lg??1:e[a]??1}var m=t(467925),h=t(947543),y=t(699473),f=t(461951),_=t(369416),x=t(785893);let{css:v,animation:S}=y.Z,w={backgroundColor:f.zsO,animation:S,borderRadius:f.saV};function b({data:e}){(0,i.useEffect)(()=>{(0,n.Z)("SkeletonPin","/app/common/react/components/SkeletonLoadingStates/SkeletonPin.tsx")},[]);let{height:a}=e;return(0,x.jsxs)(i.Fragment,{children:[(0,x.jsx)(_.Z,{unsafeCSS:v}),(0,x.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:w},"data-test-id":"skeleton-pin",children:(0,x.jsx)(l.xu,{height:a})})]})}var k=t(93966),P=t(675973),F=t(15667),C=t(647709),R=t(603316),j=t(160374),I=t(183152);function T(e){(0,i.useEffect)(()=>{(0,n.Z)("Masonry","/app/packages/gestaltExtensions/Masonry/Masonry.tsx")},[]);let{align:a,cacheKey:t,id:d,isFetching:c,isGridCentered:y=!0,items:f,layout:v,loadItems:S,masonryRef:w,optOutFluidGridExperiment:T=!1,renderItem:E,scrollContainerRef:Z,virtualize:M=!0,getColumnSpanConfig:D,_getResponsiveModuleConfigForSecondItem:K,isLoadingStateEnabled:L,initialLoadingStatePinCount:A,isLoadingAccessibilityLabel:$,isLoadedAccessibilityLabel:O}=e,B=(0,C.ZP)(),N=(0,F.B)(),{isAuthenticated:z,isRTL:U}=N,{logContextEvent:W}=(0,s.u)(),V=(0,P.Z)(),G="desktop"===B,H=(0,I.Zv)(),Y=(0,j.DB)(),X=((0,i.useRef)(f.map(()=>({fetchTimestamp:Date.now(),measureTimestamp:Date.now(),hasRendered:!1,pageCount:0}))),G&&!T),{experimentalColumnWidth:q,experimentalGutter:Q}=(0,m.Z)(X),J=e.serverRender??!!G,ee="flexible"===v||"uniformRowFlexible"===v||"desktop"!==B||X,ea=(ee&&v?.startsWith("uniformRow")?"uniformRowFlexible":void 0)??(J?"serverRenderedFlexible":"flexible"),et=e.columnWidth??q??k.yF;ee&&(et=Math.floor(et));let en=e.gutterWidth??Q??(G?k.oX:1),ei=e.minCols??k.yc,el=((0,i.useRef)(0),et+en),er=function(e){if(null==e)return;let a=function(e){let a=u[e];return a&&a.screenWidth===window.innerWidth||(u[e]={screenWidth:window.innerWidth}),u[e]}(e);return a.measurementCache||(a.measurementCache=new p),a.measurementCache}(t),es=(0,i.useCallback)(()=>Z?.current||window,[Z]),eo=(0,i.useRef)(!0),{anyEnabled:ed}=V.checkExperiment("web_masonry_pin_overlap_calculation_and_logging"),{anyEnabled:eu,group:ec}=V.checkExperiment("web_masonry_fluid_reflow"),{anyEnabled:ep}=V.checkExperiment("visual_search_stl_eligibility_check_migration_gss_css",{dangerouslySkipActivation:!0}),eg=y&&eo.current?"centered":"",{className:em,styles:eh}=function(e){let a=`m_${Object.keys(e).sort().reduce((a,t)=>{let n=e[t];return null==n||"object"==typeof n||"function"==typeof n?a:"boolean"==typeof n?a+(n?"t":"f"):a+n},"").replace(/\:/g,"\\:")}`,{flexible:t,gutterWidth:n,isRTL:i,itemWidth:l,maxColumns:r,minColumns:s,items:o,getColumnSpanConfig:d,_getResponsiveModuleConfigForSecondItem:u}=e,c=d?o.map((e,a)=>({index:a,columnSpanConfig:d(e)??1})).filter(e=>1!==e.columnSpanConfig):[],p=l+n,m=Array.from({length:r+1-s},(e,a)=>a+s).map(e=>{let m,h,y=e===s?0:e*p,f=e===r?null:(e+1)*p-.01;d&&u&&o.length>1&&(m=d(o[0]),h=u(o[1]));let{styles:_,numberOfVisibleItems:x}=c.reduce((i,r)=>{let{columnSpanConfig:s}=r,d=Math.min(function({columnCount:e,columnSpanConfig:a,firstItemColumnSpanConfig:t,isFlexibleWidthItem:n,secondItemResponsiveModuleConfig:i}){let l=e<=2?"sm":e<=4?"md":e<=6?"lg1":e<=8?"lg":"xl",r=g(a,l);if(n){let a=g(t,l);r="number"==typeof i?i:i?Math.max(i.min,Math.min(i.max,e-a)):1}return r}({columnCount:e,columnSpanConfig:s,isFlexibleWidthItem:!!h&&r===o[1],firstItemColumnSpanConfig:m??1,secondItemResponsiveModuleConfig:h??1}),e),u=null!=r.index&&i.numberOfVisibleItems>=d+r.index,c=t?100/e*d:l*d+n*(d-1),{numberOfVisibleItems:p}=i;return u?p-=d-1:r.index<p&&(p+=1),{styles:i.styles.concat(function({className:e,index:a,columnSpanConfig:t,visible:n,width:i,flexible:l}){let r="number"==typeof t?t:btoa(JSON.stringify(t));return l?`
      .${e} .static[data-column-span="${r}"]:nth-child(${a+1}) {
        visibility: ${n?"visible":"hidden"} !important;
        position: ${n?"inherit":"absolute"} !important;
        width: ${i}% !important;
      }`:`
      .${e} .static[data-column-span="${r}"]:nth-child(${a+1}) {
        visibility: ${n?"visible":"hidden"} !important;
        position: ${n?"inherit":"absolute"} !important;
        width: ${i}px !important;
      }`}({className:a,index:r.index,columnSpanConfig:s,visible:u,width:c,flexible:t})),numberOfVisibleItems:p}},{styles:"",numberOfVisibleItems:e}),v=t?`
      .${a} .static {
        box-sizing: border-box;
        width: calc(100% / ${e}) !important;
      }
    `:`
      .${a} {
        max-width: ${e*p}px;
      }

      .${a} .static {
        width: ${l}px !important;
      }
    `;return{minWidth:y,maxWidth:f,styles:`
      .${a} .static:nth-child(-n+${x}) {
        position: static !important;
        visibility: visible !important;
        float: ${i?"right":"left"};
        display: block;
      }

      .${a} .static {
        padding: 0 ${n/2}px;
      }

      ${v}

      ${_}
    `}}),h=m.map(({minWidth:e,maxWidth:a,styles:t})=>`
    @container (min-width: ${e}px) ${a?`and (max-width: ${a}px)`:""} {
      ${t}
    }
  `),y=m.map(({minWidth:e,maxWidth:a,styles:t})=>`
    @media (min-width: ${e}px) ${a?`and (max-width: ${a}px)`:""} {
      ${t}
    }
  `),f=`
    ${h.join("")}
    @supports not (container-type: inline-size) {
      ${y.join("")}
    }
  `;return{className:a,styles:`
    .masonryContainer:has(.${a}) {
      container-type: inline-size;
    }

    .masonryContainer > .centered {
      margin-left: auto;
      margin-right: auto;
    }

    .${a} .static {
      position: absolute !important;
      visibility: hidden !important;
    }

    ${f}
  `}}({gutterWidth:en,flexible:ee,items:f,isRTL:U,itemWidth:et,maxColumns:e.maxColumns??Math.max(f.length,k.g5),minColumns:ei,getColumnSpanConfig:D,_getResponsiveModuleConfigForSecondItem:K}),ey=`${eg} ${em}`.trim(),{anyEnabled:ef,expName:e_,group:ex,isMeasureAllEnabled:ev}=(0,h.Z)(),eS=((0,i.useRef)(void 0),(0,i.useRef)(f.length)),ew=(0,i.useRef)(0),eb=(0,i.useRef)(null);(0,i.useEffect)(()=>{eS.current=f.length,ew.current+=1},[f]),(0,i.useEffect)(()=>{if(eo.current&&(eo.current=!1),window.earlyGridRenderStats){let e={...(0,j.M3)({earlyHydrationConfig:Y,handlerId:H,requestContext:N}),status:window.earlyGridRenderStats.status??"unknown"};(0,R.nP)(`earlyHydrationDebug.masonry.earlyGridRender.status.${window.earlyGridRenderStats.status}`,{tags:e}),(0,R.LY)("earlyHydrationDebug.masonry.earlyGridRender.init",window.earlyGridRenderStats.init,{tags:e}),window.earlyGridRenderStats.start&&(0,R.LY)("earlyHydrationDebug.masonry.earlyGridRender.start",window.earlyGridRenderStats.start,{tags:e}),window.earlyGridRenderStats.end&&(0,R.LY)("earlyHydrationDebug.masonry.earlyGridRender.end",window.earlyGridRenderStats.end,{tags:e})}},[]),(0,i.useEffect)(()=>()=>{},[]);let ek=(0,i.useCallback)(e=>{let a=e.reduce((e,a)=>e+a),t=a/e.length;(0,R.nP)("webapp.masonry.multiColumnWhitespace.count",{sampleRate:1,tags:{fluidResizeExperiment:ec||"unknown",experimentalMasonryGroup:ex||"unknown",handlerId:H,isAuthenticated:z,multiColumnItemSpan:e.length}}),(0,R.S0)("webapp.masonry.multiColumnWhitespace.average",t,{sampleRate:1,tags:{columnWidth:et,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",handlerId:H,isAuthenticated:z,minCols:ei,multiColumnItemSpan:e.length}}),W({event_type:15878,component:14468,aux_data:{total_whitespace_px:a}}),W({event_type:16062,component:14468,aux_data:{average_whitespace_px:t}}),W({event_type:16063,component:14468,aux_data:{max_whitespace_px:Math.max(...e)}}),e.forEach(a=>{a>=50&&((0,R.nP)("webapp.masonry.multiColumnWhitespace.over50",{sampleRate:1,tags:{experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",handlerId:H,isAuthenticated:z,multiColumnItemSpan:e.length}}),W({event_type:16261,component:14468})),a>=100&&((0,R.nP)("webapp.masonry.multiColumnWhitespace.over100",{sampleRate:1,tags:{experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",handlerId:H,isAuthenticated:z,multiColumnItemSpan:e.length}}),W({event_type:16262,component:14468}))})},[et,ex,ec,H,z,W,ei]),{_items:eP,_renderItem:eF}=function({initialLoadingStatePinCount:e=50,infiniteScrollPinCount:a=10,isFetching:t,items:n=[],renderItem:l,isLoadingStateEnabled:r}){let s=+(n.filter(e=>"object"==typeof e&&null!==e&&"type"in e&&"closeup_module"===e.type).length>0),o=r&&t,d=(0,i.useMemo)(()=>Array.from({length:n.length>s?a:e}).reduce((e,a,t)=>[...e,{height:t%2==0?356:236,key:`skeleton-pin-${t}`,isSkeleton:!0}],[]),[n.length,s,a,e]);return{_items:(0,i.useMemo)(()=>o?[...n,...d]:n,[o,n,d]),_renderItem:(0,i.useMemo)(()=>r?e=>{let{itemIdx:a,data:t}=e;return a>=n.length&&t&&"object"==typeof t&&"key"in t&&"height"in t?(0,x.jsx)(b,{data:t},t.key):l(e)}:l,[r,l,n.length])}}({isLoadingStateEnabled:L,items:f,renderItem:(0,i.useCallback)(e=>(0,x.jsx)(o.Z,{name:"MasonryItem",children:E(e)}),[E]),isFetching:c,initialLoadingStatePinCount:A}),eC=L&&c,eR=(0,i.useRef)(new Set);(0,i.useEffect)(()=>{if(!ed)return;let e=setTimeout(()=>{requestAnimationFrame(()=>{let e=Array.from(eb.current?.querySelectorAll("[data-grid-item-idx]")??[]);if(0===e.length)return;let a=e.map(e=>{let a=e.getAttribute("data-grid-item-idx");return{rect:e.getBoundingClientRect(),itemIdx:a}}),t=0,n=0,i=0,l=0,r=0,s=0;for(let e=0;e<a.length;e+=1){let o=a[e]?.rect,d=a[e]?.itemIdx;for(let u=e+1;u<a.length;u+=1){let e=a[u]?.rect,c=a[u]?.itemIdx;if(o&&e&&d&&c){let a=[d,c].sort().join("|");if(!eR.current.has(a)&&o.right>=e.left&&o.left<=e.right&&o.bottom>=e.top&&o.top<=e.bottom&&o.height>0&&e.height>0){eR.current.add(a),t+=1;let d=Math.max(0,Math.min(o.right,e.right)-Math.max(o.left,e.left))*Math.max(0,Math.min(o.bottom,e.bottom)-Math.max(o.top,e.top));d>8e4?s+=1:d>4e4?r+=1:d>1e4?l+=1:d>5e3?i+=1:d>2500&&(n+=1)}}}}t>0&&(0,R.QX)("webapp.masonry.pinOverlapHits",t,{tags:{isAuthenticated:z,isDesktop:G,handlerId:H,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",visualSearchSTLexperiment:ep?"true":"false"}}),n>0&&(0,R.QX)("webapp.masonry.pinOverlap.AreaPx.over2500",n,{tags:{isAuthenticated:z,isDesktop:G,handlerId:H,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",visualSearchSTLexperiment:ep?"true":"false"}}),i>0&&(0,R.QX)("webapp.masonry.pinOverlap.AreaPx.over5000",i,{tags:{isAuthenticated:z,isDesktop:G,handlerId:H,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",visualSearchSTLexperiment:ep?"true":"false"}}),l>0&&(0,R.QX)("webapp.masonry.pinOverlap.AreaPx.over10000",l,{tags:{isAuthenticated:z,isDesktop:G,handlerId:H,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",visualSearchSTLexperiment:ep?"true":"false"}}),r>0&&(0,R.QX)("webapp.masonry.pinOverlap.AreaPx.over40000",r,{tags:{isAuthenticated:z,isDesktop:G,handlerId:H,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",visualSearchSTLexperiment:ep?"true":"false"}}),s>0&&(0,R.QX)("webapp.masonry.pinOverlap.AreaPx.over80000",s,{tags:{isAuthenticated:z,isDesktop:G,handlerId:H,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",visualSearchSTLexperiment:ep?"true":"false"}})})},1e3);return()=>{clearTimeout(e)}},[et,ex,ec,z,G,ed,f,H,ep]);let ej=(0,r.Z)(),eI=(0,i.useCallback)(e=>{w&&(w.current=e)},[w]);return(0,x.jsxs)(i.Fragment,{children:[L&&!eo.current&&(0,x.jsx)(l.xu,{"aria-live":"polite",display:"visuallyHidden",children:eC?$:O}),(0,x.jsx)("div",{ref:eb,"aria-busy":L?!!eC:void 0,className:"masonryContainer","data-test-id":"masonry-container",id:d,style:X?{padding:`0 ${en/2}px`}:void 0,children:(0,x.jsxs)("div",{className:ey,children:[J&&eo.current?(0,x.jsx)(_.Z,{"data-test-id":"masonry-ssr-styles",unsafeCSS:eh}):null,(0,x.jsx)(l.xu,{"data-test-id":"max-width-container",marginBottom:0,marginEnd:"auto",marginStart:"auto",marginTop:0,maxWidth:e.maxColumns?el*e.maxColumns:void 0,children:ef?(0,x.jsx)(l.GX,{ref:ej?eI:e=>{w&&(w.current=e)},_dynamicHeights:!0,_getResponsiveModuleConfigForSecondItem:K,_logTwoColWhitespace:ek,_measureAll:ev,align:a,columnWidth:et,getColumnSpanConfig:D,gutterWidth:en,items:eP,layout:ee?ea:v??"basic",loadItems:S,measurementStore:er,minCols:ei,renderItem:eF,scrollContainer:es,virtualBufferFactor:.3,virtualize:M}):(0,x.jsx)(l.Rk,{ref:ej?eI:e=>{w&&(w.current=e)},_dynamicHeights:!0,_fluidResize:eu,_getResponsiveModuleConfigForSecondItem:K,_logTwoColWhitespace:ek,align:a,columnWidth:et,getColumnSpanConfig:D,gutterWidth:en,items:eP,layout:ee?ea:v??"basic",loadItems:S,measurementStore:er,minCols:ei,renderItem:eF,scrollContainer:es,virtualBufferFactor:.3,virtualize:M})})]})})]})}},115247:function(e,a,t){t.d(a,{Z:()=>r});var n=t(667294);function i(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class l extends n.Component{constructor(...e){super(...e),i(this,"ref",(0,n.createRef)()),i(this,"observer",null),i(this,"handleVisibilityChanged",(e,a)=>{this.props.onVisibilityChange(e,a)})}componentDidMount(){this.ref&&this.ref.current&&(this.observer=new window.IntersectionObserver(this.handleVisibilityChanged,this.props.options),this.observer.observe(this.ref.current))}componentWillUnmount(){this.observer&&(this.observer.unobserve(this.ref.current),delete this.observer)}render(){return this.props.children(this.ref)}}let r=l},377654:function(e,a,t){t.d(a,{Rq:()=>n,Vf:()=>i,jd:()=>l,oy:()=>r});let n=e=>"ios"===e&&(window.devicePixelRatio||1)*window.screen.height==2436,i=28,l=e=>window.innerHeight>=748&&n(e),r=()=>"undefined"!=typeof window&&!!window.navigator&&(/iPad/.test(navigator.platform)||"MacIntel"===navigator.platform&&"ontouchend"in document&&Math.min(window.screen.width,window.screen.height)>=700)},914061:function(e,a,t){t.r(a),t.d(a,{default:()=>c});var n=t(281098),i=t(667294),l=t(20256),r=t(93966),s=t(377654),o=t(657389),d=t(15667),u=t(785893);let c=({children:e,dataLayoutShiftBoundaryId:a,hasFixedHeader:t=!1,hasGutter:c=!0,height:p,showKeychainError:g=!1,useViewport:m=!1})=>{(0,i.useEffect)(()=>{(0,n.Z)("MobilePageContainer","/app/packages/layout/MobilePageContainer.tsx")},[]);let h=(0,d.B)(),y=(0,s.jd)(h.userAgent.platform)?s.Vf:0;return(0,u.jsx)(l.xu,{"data-layout-shift-boundary-id":a||"PageContainer",height:m?`calc(100vh - ${y}px)`:p,paddingX:c?r.D6:void 0,paddingY:t||g?void 0:3,children:(0,u.jsx)(o.C,{value:!!c,children:e})})}},267828:function(e,a,t){t.d(a,{r:()=>n});function n(e,a,t){return!!(e&&e.trim().length>0&&a&&!t)}},918874:function(e,a,t){t.d(a,{Z:()=>s}),t(167912);var n,i=t(28427),l=t(19585);let r=(void 0!==n||(n=t(799956)).hash&&"01a93671cde480baa2cfd8b781589acd"!==n.hash&&console.error("The definition of 'useNormalizePinData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),s=e=>{let a,t=(0,l.ZP)(),n=(0,i.Z)(r,e),s=n.trackedLink||n.link||n.imageSpec_orig&&n.imageSpec_orig.url,{richMetadata:o,richSummary:d}=n,u=t._('Saved from ', 'Closeup pin annotation', 'Closeup pin annotation');return o&&o.products&&o.products[0]&&o&&o.products[0].name&&o.products[0].offerSummary&&(u=t._('Product sold by ', 'pin annotation', 'pin annotation'),a=(o.products?.[0]||void 0)?.offerSummary),!a&&d&&d&&d.products&&d.products[0]&&d&&d.products[0].name&&d.products[0].offerSummary&&(u=t._('Product sold by ', 'pin annotation', 'pin annotation')),{pinLink:s,pinCreditPrefix:u,pinTitle:n.closeupUnifiedTitle,pinDescription:n.closeupUnifiedDescription,pinCategory:n.category}}},636208:function(e,a,t){t.d(a,{Z:()=>n});function n(e,a,t,i=0){if(-1===a||-1===t||a===t)return e;let l=t+i,r=a+i;if(l<0||l>=e.length||r<0||r>=e.length)return e;let s=[...e],o=s[r],d=r<l?1:-1;for(let a=r;a!==l;a+=d)s[a]=e[a+d];return s[l]=o,s}},123998:function(e,a,t){t.d(a,{Z:()=>_});var n=t(281098),i=t(667294),l=t(20256),r=t(390843),s=t(115247),o=t(15667),d=t(734215),u=t(998212),c=t(732888),p=t(738140),g=t(169053),m=t(785893);function h(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class y extends i.Component{constructor(e){super(e),h(this,"componentWillUnmount",()=>{this.unregisterComponent()}),h(this,"getContext",()=>{let{clientTrackingParams:e,component:a,element:t,objectId:n,timeSpentContext:i,view:l,viewParameter:r}=this.props;return{view:l||i?.view,viewParameter:r||i?.viewParameter,component:a||i?.component,element:t,objectId:n||i?.objectId,clientTrackingParams:e||i?.clientTrackingParams,getParentUuid:()=>this.getUuid(),getGrandparentUuid:()=>this.getParentId()}}),h(this,"getLoggerContext",()=>{let e={...this.getContext()};return delete e.getParentUuid,e}),h(this,"getParentId",()=>{let{timeSpentContext:e,shouldUseGrandparentId:a=!1}=this.props;if(a&&e&&e.getGrandparentUuid){let a=e.getGrandparentUuid();if(a)return a}return e?.getParentUuid?.()}),h(this,"getUuid",()=>this.state.timedPair?this.state.timedPair.uuid:void 0),h(this,"getTimedPair",()=>this.state.timedPair),h(this,"setTimedPair",(e,a)=>{this.setState({timedPair:e},()=>{a&&a()})}),h(this,"isRegistered",!1),h(this,"registerComponent",()=>{this.props.timeSpentManager.registerComponent(this),this.isRegistered=!0}),h(this,"unregisterComponent",()=>{this.isRegistered&&(this.props.timeSpentManager.unregisterComponent(this),this.isRegistered=!1)}),h(this,"handleVisibilityChange",e=>{let{intersectionRatio:a}=e[0],{bottom:t,left:n,right:i,top:l}=e[0].intersectionRect;a>0?this.registerComponent():0===a&&(0===t&&0===n&&0===i&&0===l?this.unregisterComponent():this.registerComponent())}),this.state={timedPair:new c.Z(this.getLoggerContext())}}componentDidUpdate(e){!this.isRegistered||e.view===this.props.view&&e.viewParameter===this.props.viewParameter&&e.component===this.props.component&&e.element===this.props.element&&e.objectId===this.props.objectId&&(0,d.Z)(e.auxData,this.props.auxData)&&(0,d.Z)(e.viewData,this.props.viewData)||(this.unregisterComponent(),setTimeout(this.registerComponent))}render(){let{children:e,intersectionObserverBoxHeight:a}=this.props;return(0,m.jsx)(p.$,{value:this.getContext(),children:(0,m.jsx)(s.Z,{onVisibilityChange:this.handleVisibilityChange,options:{threshold:0},children:t=>(0,m.jsx)(l.xu,{ref:t,height:a??"100%",children:i.Children.only(e)})})})}componentDidMount(){(0,n.Z)("DeprecatedTimeSpent","/app/packages/time-spent/DeprecatedTimeSpent.tsx")}}function f(e){let a=(0,r.ou)(),t=(0,p.a)(),n=(0,u.Z)(),l=(0,g.EQ)(),{requestIdentifier:s=""}=(0,o.B)(),d={app_instance_id:s.slice(0,8),...e.auxData??{}};return(0,i.useEffect)(()=>{n?.setHistoryStackContext(a)},[a,n]),(0,i.useEffect)(()=>{n?.setPins(l??{})},[l,n]),n?(0,m.jsx)(y,{...e,auxData:d,timeSpentContext:t,timeSpentManager:n,children:e.children}):e.children}f.displayName="DeprecatedTimeSpent";let _=f},738140:function(e,a,t){t.d(a,{$:()=>n,a:()=>i});let{Provider:n,getMaybe:i}=(0,t(729434).Z)("timeSpentContext")},732888:function(e,a,t){t.d(a,{Z:()=>s,h:()=>r});var n=t(172045),i=t(17314);function l(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}let r="undefined"!=typeof window&&window.performance&&window.performance.now?()=>Math.floor((window.performance.timeOrigin+window.performance.now())*1e6):()=>1e6*Date.now(),s=class{constructor(e){l(this,"start",()=>(this.startTime=r(),this.startTime)),l(this,"end",()=>(this.endTime=r(),this.duration=this.startTime?this.endTime-this.startTime:null,this.duration));try{this.uuid=(0,n.Z)()}catch(e){this.uuid=(0,i.Z)()}e&&Object.assign(this,e)}}},359829:function(e,a,t){t.d(a,{Z:()=>n});function n(e,a){let t=0,n=!1,i=-1;return e.forEach((e,l)=>{let{x:r=0,y:s=0,h:o=0,w:d=0}=e,u=function(e,a){let{x:t,y:n,w:i,h:l}=e,{x:r,y:s,w:o,h:d}=a,u=Math.max(t,r),c=Math.min(t+i,r+o),p=Math.max(n,s),g=Math.min(n+l,s+d),m=u<c&&p<g?(c-u)*(g-p):0;return m/(i*l+o*d-m)}(a,{x:r,y:s,h:o,w:d});u>=.9&&u>t&&(t=u,n=!0,i=l)}),{isCropAreaOnDotArea:n,indexToHide:i}}},611304:function(e,a,t){t.d(a,{Z:()=>n});function n(e){return{h:e?.h??void 0,is_stela:e?.isStela??void 0,labelId:e?.labelId??void 0,label_x:e?.labelX??void 0,label_y:e?.labelY??void 0,label:e?.label??void 0,max_annotation_num_documents:e?.maxAnnotationNumDocuments??void 0,score:e?.score??void 0,show_on_closeup:e?.showOnCloseup??void 0,title:e?.title??void 0,w:e?.w??void 0,x:e?.x??void 0,y:e?.y??void 0}}},739067:function(e,a,t){t.d(a,{Z:()=>n});function n(e,a){let{x:t,y:n}=e,i=!1,l=0,r=a.length-1;for(;l<a.length;){let{x:e,y:s}=a[l],{x:o,y:d}=a[r];s>n!=d>n&&t<(o-e)*(n-s)/(d-s)+e&&(i=!i),r=l,l+=1}return i}},68408:function(e,a,t){t.d(a,{Z:()=>d});var n,i=t(667294);t(167912);var l=t(28427),r=t(675973),s=t(886981);let o=(void 0!==n||(n=t(160187)).hash&&"50c726067ab8af873ed4afded90b7bed"!==n.hash&&console.error("The definition of 'useSamSegmentation_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function d({boundingBox:e,pinKey:a}){let{checkExperiment:t}=(0,r.Z)(),n=(0,l.Z)(o,a),d=t("dtn_exp6_uve4a").group,u=(0,i.useMemo)(()=>"enabled"===d?{detection_model:"dtn_exp6_yolov8",use_gss:!1,write_to_galaxy:!1}:"enabled_dtn_exp5_skip_gss"===d?{use_gss:!1,write_to_galaxy:!1}:{},[d]),{data:c}=(0,s.Z)(n.entityId?{name:"ApiResource",options:{url:`/v3/pins/${n.entityId}/segmentation/sam/`,data:{bounding_box:e?JSON.stringify({x:Math.min(Math.max(e.x||0,0),1),y:Math.min(Math.max(e.y||0,0),1),width:Math.min(Math.max(e.w||1,0),1),height:Math.min(Math.max(e.h||1,0),1)}):void 0,client:"visual_cutout",use_gss:!e,write_to_galaxy:!e,cleanup_masks:!0,...u}}}:null);return c}},751961:function(e,a,t){t.d(a,{Z:()=>s});var n=t(281098),i=t(667294),l=t(366859),r=t(785893);let s=({children:e})=>((0,i.useEffect)(()=>{(0,n.Z)("FeedItemPinRepWrapper","/app/www/FeedItemPinRepWrapper.tsx")},[]),(0,r.jsx)(l.Z,{onTouch:e=>{if(e.target instanceof HTMLElement&&"IMG"===e.target.tagName){let a=e.target.getBoundingClientRect().top+window.scrollY-70;window.scrollTo(window.scrollX,a)}},pressState:"none",children:e}))},425140:function(e,a,t){t.d(a,{G:()=>x,Z:()=>v});var n=t(281098),i=t(667294),l=t(20256),r=t(469167),s=t(467925),o=t(93966),d=t(355363),u=t(62937),c=t(647709),p=t(341742),g=t(348268),m=t(357823),h=t(130858),y=t(79293),f=t(648200),_=t(785893);let x=25;function v({align:e,customLayoutType:a,getColumnSpanConfig:t,getResponsiveModuleConfigForSecondItem:x,emptyState:v,feedItems:S,feedKey:w,maxColumns:b,minColumns:k,pagination:{hasNext:P,isLoadingNext:F,loadNext:C,refetch:R},pullToRefresh:j,renderFeedItem:I,serverRender:T,isLoadingStateEnabled:E,isLoadingAccessibilityLabel:Z,isLoadedAccessibilityLabel:M,layout:D,forceShowLoadingState:K}){(0,i.useEffect)(()=>{(0,n.Z)("SimpleFeed","/app/www/SimpleFeed.tsx")},[]);let L=(0,c.HG)(),{experimentalColumnWidth:A,experimentalGutter:$}=(0,s.Z)(),[O,B]=(0,i.useState)(!1),N=1===b?window.innerWidth:void 0,z="userSearch"===a?window.innerWidth-16:200,U=F&&0===S.length&&!O&&!E,W="desktopFlashlight"===a||"ideaPage"===a&&L?-2:o.qG,V=k??2;return"userSearch"===a&&(V=1),(0,p.Z)(()=>(window.addEventListener("online",C),()=>window.removeEventListener("online",C))),(0,_.jsxs)(l.xu,{"data-test-id":"MobileFeed",children:[(0,_.jsx)(m.Z,{enabled:!!j,onPull:()=>{R(),B(!0)},refreshing:O}),(0,_.jsxs)(l.xu,{"data-test-id":"grid",marginEnd:W,marginStart:W,opacity:O?.5:1,children:[(0,_.jsx)(d.Z,{isAtEndOfFeed:!P,isPlaceholderGrid:E&&F&&!S.length,itemCount:S.length,children:S.length?(0,_.jsx)(l.xu,{"data-test-id":"feed",marginTop:(0,g.kk)({isDesktop:L}),children:(0,_.jsx)(u.Z.Consumer,{children:n=>(0,_.jsx)(i.Fragment,{children:(0,_.jsx)(f.Z,{children:(0,_.jsx)(r.default,{_getResponsiveModuleConfigForSecondItem:x,align:e||("ideaPage"===a?"start":void 0),cacheKey:w,columnWidth:L?A??o.yF:N??z,getColumnSpanConfig:t,gutterWidth:L?$??4*o.jC:void 0,id:T?w:void 0,isFetching:K??F,isLoadedAccessibilityLabel:M??"",isLoadingAccessibilityLabel:Z??"",isLoadingStateEnabled:K??!!E,items:K?[]:S,layout:D??void 0,loadItems:C,maxColumns:b,minCols:V,optOutFluidGridExperiment:null!=b,renderItem:({data:e,itemIdx:a})=>I(e,a),scrollContainerRef:n,serverRender:T})})})})}):F?(0,_.jsx)(h.Z,{}):v??null}),U&&(0,_.jsx)(l.xu,{column:12,paddingY:2,children:(0,_.jsx)(y.Z,{partialViewportWidth:"desktopFlashlight"===a})})]})]})}},290003:function(e,a,t){t.d(a,{Z:()=>eX});var n,i,l,r,s,o,d,u=t(281098),c=t(667294);t(167912);var p=t(616550),g=t(20256),m=t(28427),h=t(801082),y=t(19585),f=t(886981),_=t(634737),x=t(825332),v=t(241646),S=t(583270),w=t(785893);function b({isTopRow:e,image:a}){return(0,c.useEffect)(()=>{(0,u.Z)("ShoppingUpsellStoryCardDetail","/app/common/react/components/shopping/ShoppingUpsellStoryCardDetail.tsx")},[]),(0,w.jsxs)(g.zd,{height:e?217:168,wash:!0,width:e?236:117,children:[a.url&&(0,w.jsx)(g.Ee,{alt:a.alt||"",fit:"cover",naturalHeight:a.height??1,naturalWidth:a.width??1,src:a.url}),!!a.price&&(0,w.jsx)(g.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"18px",color:"#111",fontSize:"10px",fontWeight:"600",lineHeight:"24px",padding:"06px"}},"data-test-id":"shopping-upsell-price",height:24,left:!0,margin:1,paddingX:2,paddingY:1,position:"absolute",top:!0,children:a.price})]})}var k=t(980787),P=t(744862),F=t(351607),C=t(97484),R=t(47426),j=t(483858),I=t(865690);let T={container:{borderRadius:`${C.Oc}px ${C.Oc}px 25px 25px`,WebkitMaskImage:"-webkit-radial-gradient(white, black)"},content:{marginBottom:"2px"},visualOverlay:{backgroundColor:"rgba(0, 0, 0, .1)"}},E=({images:e,firstImageIndex:a})=>{let t=a+1,n=a+2;return(0,w.jsxs)(g.xu,{overflow:"hidden",rounding:4,children:[(0,w.jsx)(g.xu,{dangerouslySetInlineStyle:{__style:T.content},children:e.at(a)?(0,w.jsx)(b,{image:e[a],isTopRow:!0}):null}),e.length>n?(0,w.jsxs)(g.kC,{alignItems:"stretch",justifyContent:"between",children:[(0,w.jsx)(b,{image:e[t]}),(0,w.jsx)(b,{image:e[n]})]}):null]})};function Z({dangerouslySetActionUrl:e,query:a,story:t,slotIndex:n}){let i,l,r,s,o;(0,c.useEffect)(()=>{(0,u.Z)("ShoppingUpsellStoryCard","/app/common/react/components/shopping/ShoppingUpsellStoryCard.tsx")},[]);let{logContextEvent:d}=(0,k.u)(),{action:p,id:m,objects:h,story_type:y,subtitle:f}=t,{text:_,url:x}=p||{},[v,S]=(0,c.useState)(!1),b=(0,c.useCallback)(()=>S(!0),[S]),C=(0,c.useCallback)(()=>S(!1),[S]),Z=(h||[]).reduce((e,a)=>"pin"!==a.type?e:[...e,{domain:a.domain,image:{alt:a.title||a.description,height:a.images?.["474x"]?.height,url:a.images?.["474x"]?.url,width:a.images?.["474x"]?.width,price:(a.rich_summary?.products?.[0]||{}).offer_summary?.price}}],[]),M=(Z[0]||{}).domain||void 0;["search_product_collage_story","shop_article_story"].includes(y)?(i=2,l=43,r={story_id:m,story_type:y,entered_query:a}):"shop_brand_story"===y||"shop_brand_affinity_story"===y?(i=1,l=92,M&&(r={story_type:y,commerce_data:JSON.stringify({domain:M})})):["stela_in_flashlight_card","stela_in_flashlight_onecol"].includes(y)?(i=72,l=3050):"related_domain_collage"===y?(i=72,l=3455):"related_products_collage"===y&&(i=1,l=3177);let D=()=>d({event_type:101,element:372,component:200,view_type:i,view_parameter:l,aux_data:{story_type:y}}),K=f?4:2;if(["related_domain_collage","shop_brand_story","shop_brand_affinity_story"].includes(y)&&p){let e=p.user;s=e&&(e.image_medium_url||e.image_large_url),o=e&&e.full_name}let L=e||x;if(!L)return null;let A=(0,R.Z)({url:L})?"nofollow":"none";return(0,w.jsx)(F.Fw,{componentType:200,contextLogData:r||{},impressionType:"Story",loggingId:y,slotIndex:n,viewParameter:l,viewType:i,children:({impressionTrackerRef:e})=>(0,w.jsx)(g.xu,{ref:e,children:(0,w.jsx)(g.Tg,{href:L,onTap:D,rel:A,children:(0,w.jsxs)(g.xu,{dangerouslySetInlineStyle:{__style:T.container},onMouseEnter:b,onMouseLeave:C,overflow:"hidden",position:"relative",children:[(0,w.jsx)(E,{firstImageIndex:+!!["related_domain_collage","related_products_collage"].includes(y),images:Z.map(({image:e})=>e)}),(0,w.jsx)(g.xu,{alignItems:"center",color:"secondary",display:"flex",justifyContent:"center",marginTop:2,paddingX:3,paddingY:K,rounding:"pill",children:(0,w.jsxs)(g.xu,{alignContent:"start",direction:"column",display:"flex",justifyContent:"center",margin:2,children:[f?(0,w.jsx)(g.xu,{marginBottom:1,children:(0,w.jsx)(g.xv,{align:"start",color:"subtle",children:f.format})}):null,(0,w.jsx)(g.xv,{align:"start",weight:"bold",children:_})]})}),o&&s&&(0,w.jsx)(g.xu,{margin:2,position:"absolute",right:!0,top:!0,children:(0,w.jsx)(P.qE,{name:o,outline:!0,size:"md",src:s})}),(0,w.jsx)(j.Z,{visibility:v?"visible":"none",children:(0,w.jsx)(I.Z,{additionalStyles:T.visualOverlay})})]})})})})}var M=t(302148),D=t(941404);let K=(void 0!==n||(n=t(135885)).hash&&"610a35d46510240eb58e262c1909310c"!==n.hash&&console.error("The definition of 'BestPinCardAttribution_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),L=()=>{(0,D.NC)("click_best_pin_board",!0)},A=()=>{(0,D.NC)("click_best_pin_profile",!0)},$=({pin:e})=>{let{pinner:a}=e,{username:t,fullName:n}=a??{},i=a?.imageMediumUrl||a?.imageSmallUrl,l=`/${t??""}/`;return(0,w.jsx)(g.Tg,{fullWidth:!1,href:l,onTap:A,rounding:"circle",children:(0,w.jsx)(P.qE,{name:n??"",outline:!0,size:"sm",src:i??""})})},O=({pin:e})=>{let a=(0,y.ZP)(),{board:t,pinner:n}=e,{name:i,privacy:l,url:r}=t??{},s=t?.entityId||"",{username:o,fullName:d}=n??{},u=`/${o??""}/`,c=(0,w.jsx)(g.xv,{inline:!0,size:"200",weight:"bold",children:(0,w.jsx)(g.rU,{display:"inlineBlock",href:u,onClick:A,underline:"hover",children:d})},d);return"protected"===l?(0,M.nk)(a._('{{ pinnerName }} saved this Pin', 'Showing who saved this pin, but not which board (private board), on closeup', 'Showing who saved this pin, but not which board (private board), on closeup'),{pinnerName:c}):(0,M.nk)(a._('{{ pinnerName }} saved to {{ boardName }}', 'Showing who saved this pin to which board on closeup', 'Showing who saved this pin to which board on closeup'),{pinnerName:c,boardName:(0,w.jsx)(g.xv,{inline:!0,size:"200",weight:"bold",children:(0,w.jsx)(g.rU,{href:r??"",onClick:L,children:i},"board")},s)})},B=({pinKey:e})=>{(0,c.useEffect)(()=>{(0,u.Z)("BestPinCardAttribution","/app/packages/BestPinCard/BestPinCardAttribution.tsx")},[]);let a=(0,m.Z)(K,e);return(0,w.jsxs)(g.xu,{alignItems:"center","data-test-id":"pin-attribution",direction:"row",display:"flex",marginTop:3,children:[(0,w.jsx)($,{pin:a}),(0,w.jsx)(g.xu,{marginEnd:2}),(0,w.jsx)(g.xv,{size:"200",children:(0,w.jsx)(O,{pin:a})})]})},N=e=>{e.target&&e.target instanceof HTMLElement&&(e.target.style.textDecoration="underline")},z=e=>{e.target&&e.target instanceof HTMLElement&&(e.target.style.textDecoration="none")};var U=t(521009);function W({pageType:e,pinCreditPrefix:a,pin:t,pinLink:n,viewParameter:i}){(0,c.useEffect)(()=>{(0,u.Z)("BestPinCardClickthroughLink","/app/packages/BestPinCard/BestPinCardClickthroughLink.tsx")},[]);let l=(0,y.ZP)(),r=(0,U.Z)();if("topic"!==e.page&&(!t.domain||"Uploaded by user"===t.domain))return null;let s="topic"!==e.page||e.isAuth?"100":"200",o="topic"===e.page&&!!t.nativeCreator,d=o?t.nativeCreator?.fullName:t.domain;return(0,w.jsx)(g.xu,{display:"flex",flex:"none",justifyContent:"start",marginBottom:2,children:(0,w.jsx)(g.rU,{display:"inlineBlock",href:o?`/${t.nativeCreator?.username||""}/`:n,onClick:()=>{"topic"===e.page?(0,D.NC)("click_topic_best_pin_link"):r({event_type:12,view_type:3,object_id_str:t.entityId,component:85,view_parameter:i})},rel:"nofollow",target:"blank",underline:"hover",children:(0,w.jsx)(g.xv,{size:s,children:(0,M.nk)(l._('{{ pinCreditPrefix }} {{ pinCredit }}', 'Tells the user where the pin is from in the form of "Saved from <website>"', 'Tells the user where the pin is from in the form of "Saved from <website>"'),{pinCreditPrefix:a,pinCredit:(0,w.jsx)(g.xv,{inline:!0,size:s,weight:"bold",children:"topic"!==e.page?(0,w.jsxs)("span",{"data-gestalt-valid-html":"Text",onBlur:z,onFocus:N,onMouseLeave:z,onMouseOver:N,children:[" ",t.domain]}):d},o?"creatorProfile":"pinLinkDomain")})})})})}var V=t(166379),G=t(110870),H=t(267828),Y=t(695263),X=t(918874),q=t(873408),Q=t(776250),J=t(492841),ee=t(594414);let ea=(void 0!==i||(i=t(815025)).hash&&"12f77507a9fdec344b44b7e659fa5ac1"!==i.hash&&console.error("The definition of 'RecipeMetadata_recipe' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function et({recipeKey:e}){(0,c.useEffect)(()=>{(0,u.Z)("RecipeMetadata","/app/packages/recipePin/RecipeMetadata.tsx")},[]);let a=(0,m.Z)(ea,e);if(a?.aggregateRating?.ratingValue&&a.aggregateRating.reviewCount){let e="number"==typeof a.cookTimes?.cook?.m&&"number"==typeof a.cookTimes.prep?.m?`${a.cookTimes.cook.m+a.cookTimes.prep.m} minutes \xb7 `:"";return(0,w.jsxs)(c.Fragment,{children:[(0,w.jsx)(ee.Z,{max_rating:a.aggregateRating.bestRating,rating:a.aggregateRating.ratingValue},a.aggregateRating.ratingValue),(0,w.jsx)(g.xv,{inline:!0,size:"200",children:` ${a.aggregateRating.reviewCount} \xb7 ${e}`})]})}return null}var en=t(15667);let ei=(void 0!==l||(l=t(5375)).hash&&"81db65fd15680cc0281b801ed4a8cb94"!==l.hash&&console.error("The definition of 'BestPinCardBody_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function el(e){(0,c.useEffect)(()=>{(0,u.Z)("BestPinCardBody","/app/packages/BestPinCard/BestPinCardBody.tsx")},[]);let{pinKey:a,viewportSize:t,pageType:n}=e,i=(0,m.Z)(ei,a),{pinCreditPrefix:l,pinLink:r}=(0,X.Z)(i),s=(0,q.Z)(i),{description:o}=(0,Y.eK)({richMetadataDescription:i.richMetadata?.description,richSummaryDisplayName:i.richSummary?.displayName,closeupUnifiedDescription:i.closeupUnifiedDescription});"videos_category"===n.page&&(o=(0,Y.kt)(o,i.nativeCreator?.username||""));let d="wide"===t,p=(0,Y.Ly)({pinTitle:i.title,gridTitle:i.gridTitle,richSummaryDisplayName:i.richSummary?.displayName??"",richMetadataTitle:i.richMetadata?.title??"",storyPinDataId:i.storyPinDataId,storyPinDataMetadataPinTitle:i.storyPinData?.metadata?.pinTitle,pinJoinVisualAnnotation:i.pinJoin?.visualAnnotation});(i.gridTitle||"").trim()&&p!==i.gridTitle&&(p=(0,Y.EU)(i.gridTitle,200));let h=(0,H.r)(i.richMetadata?.recipe?.name,!!i.richMetadata?.recipe?.categorizedIngredients,i.richMetadata?.recipe?.fromAggregatedData??!1)?i.richMetadata?.recipe:null,y=!!(i.richMetadata&&i.richMetadata.article&&i.richMetadata.article.datePublished)&&((e,a)=>{let t=new Date((e.richMetadata??{}).article?.datePublished??Date.now()),n=t.getTime();return new Date().getTime()-n<=63072e6?(0,w.jsx)(V.Z,{dateFormatType:V.k.LONG_MONTH_YEAR,useUTC:!1,value:t}):""})(i,0),f=(e=>{let a,t,n="";if(e.richMetadata&&e.richMetadata.article&&e.richMetadata.article.datePublished)return n;let i=(a=null,e.lastRepinDate&&(a=new Date(e.lastRepinDate)),t=null,(e.createdAt&&(t=new Date(e.createdAt)),a)?t?a>t?a:t:a:t);if(i&&i.getFullYear()===new Date().getFullYear()){let a=new Set(["film_music_books","art","home_decor","food_drink","womens_fashion","travel","weddings","hair_beauty","holidays_events","mens_fashion","products","celebrities","technology"]),{category:t}=e;a.has(t)&&(n=i?(0,w.jsx)(V.Z,{dateFormatType:V.k.LONG_MONTH_YEAR,useUTC:!1,value:i}):"")}return n})(i)||y,{isBot:_,isSocialBot:x}=(0,en.B)();return(0,w.jsx)(g.xu,{alignContent:"between","data-test-id":"UnauthBestPinCardBodyContainer",direction:"column",display:"flex",flex:"grow",padding:8,position:"relative",width:"100%",children:(0,w.jsxs)(g.xu,{direction:"column",display:"flex",flex:"grow",position:"relative",children:[(0,w.jsx)(W,{pageType:n,pin:{entityId:i.entityId,domain:i.domain||"",nativeCreator:i.nativeCreator&&{fullName:i.nativeCreator.fullName,username:i.nativeCreator.username}},pinCreditPrefix:"topic"===n.page&&i.nativeCreator?"Created by":l,pinLink:r??"",viewParameter:(0,Q.Z)({hasPin:!0,hasPinRichMetadata:!!i.richMetadata,hasPinRichMetadataProducts:!!i.richMetadata?.products,hasPinRichMetadataArticle:!!i.richMetadata?.article,hasPinRichMetadataRecipe:!!i.richMetadata?.recipe,hasPinStoryPinData:!!i.storyPinData})}),(0,w.jsx)(g.kC,{direction:"row",justifyContent:"between",children:(0,w.jsx)(g.xu,{display:"flex",marginEnd:3*!d,marginTop:3*!!d,overflow:"hidden",children:p&&(0,w.jsx)("h2",{"data-test-id":"UnauthBestPinCardTitle",style:{fontWeight:600,fontSize:"28px",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:p})})}),f?(0,w.jsx)(g.xu,{marginTop:1,children:(0,w.jsx)(g.xv,{color:"subtle",children:f})}):null,o&&(0,w.jsx)(g.xu,{display:"flex",marginTop:3,overflow:"hidden",children:(0,w.jsxs)("h3",{style:{fontWeight:"normal",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",fontSize:"14px"},children:[h&&(0,w.jsx)(et,{recipeKey:h}),o]})}),h&&(0,w.jsx)(J.Z,{marginOverrides:h?{outerMarginTop:32,ingredientMarginBottom:4}:null,recipeProps:{recipe:{categorizedIngredients:h.categorizedIngredients,name:h.name,image:(0,G.Z)({imagesUrls:s,embedSrc:i.embed?.src,embedType:i.embed?.type,excludeOriginals:!_&&!x})}}}),(0,w.jsx)(g.xu,{alignItems:"center",direction:"row",display:"flex",justifyContent:"between",marginTop:2,children:(0,w.jsx)(B,{pinKey:i})})]})})}var er=t(642407),es=t(633301);let eo={nw:0,ne:90,se:180,sw:270},ed={ne:[7,-7],se:[7,7],sw:[-7,7],nw:[-7,-7]},eu={nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};function ec({corner:e,x:a,y:t,size:n,cornerStyle:i}){return(0,c.useEffect)(()=>{(0,u.Z)("CropperCorner","/app/packages/Cropper/CropperCorner.tsx")},[]),(0,w.jsxs)("g",{"data-test-id":`cropper-corner-${e}`,style:{cursor:eu[e],pointerEvents:"auto"},transform:((e,a,t,n)=>{if("rounded"!==n)return`translate(${a}, ${t}), rotate(${eo[e]})`;{let[n,i]=ed[e];return`translate(${a+n}, ${t+i}), rotate(${eo[e]})`}})(e,a,t,i),children:[(0,w.jsx)("rect",{className:`cropperHandle ${e}`,fill:"rgba(0,0,0,0)",height:n,stroke:"none",width:n,x:0,y:0}),"rounded"===i?(0,w.jsx)("path",{className:`cropperHandle ${e}`,d:"M16 0H24V8H16C11.5817 8 8 11.5817 8 16V24H0V16C0 7.16343 7.16345 0 16 0Z",fill:"#fff"}):(0,w.jsx)("path",{className:`cropperHandle ${e}`,d:`M ${n} 0 L 0 0 L 0 ${n}`,fill:"none",stroke:"#fff",strokeWidth:6})]})}let ep={n:"ns-resize",s:"ns-resize",e:"ew-resize",w:"ew-resize"};function eg({edge:e,x:a,y:t,w:n,h:i}){return(0,c.useEffect)(()=>{(0,u.Z)("CropperEdge","/app/packages/Cropper/CropperEdge.tsx")},[]),(0,w.jsx)("rect",{className:`cropperHandle ${e}`,fill:"rgba(0,0,0,0)",height:i,stroke:"none",style:{cursor:ep[e],pointerEvents:"auto"},width:n,x:a,y:t})}function em({x:e,y:a,w:t,h:n}){(0,c.useEffect)(()=>{(0,u.Z)("CropperHandles","/app/packages/Cropper/CropperHandles.tsx")},[]);let i="rounded";return(0,w.jsxs)(c.Fragment,{children:[(0,w.jsx)(ec,{corner:"nw",cornerStyle:i,size:20,x:e,y:a}),(0,w.jsx)(ec,{corner:"ne",cornerStyle:i,size:20,x:e+t,y:a}),(0,w.jsx)(ec,{corner:"sw",cornerStyle:i,size:20,x:e,y:a+n}),(0,w.jsx)(ec,{corner:"se",cornerStyle:i,size:20,x:e+t,y:a+n}),(0,w.jsx)(eg,{edge:"n",h:30,w:Math.max(t-40,0),x:e+20,y:a-10}),(0,w.jsx)(eg,{edge:"e",h:Math.max(n-40,0),w:30,x:e+t-20,y:a+20}),(0,w.jsx)(eg,{edge:"s",h:30,w:Math.max(t-40,0),x:e+20,y:a+n-10}),(0,w.jsx)(eg,{edge:"w",h:Math.max(n-40,0),w:30,x:e-20,y:a+20})]})}var eh=t(598600),ey=t(187356),ef=t(369416),e_=t(341742),ex=t(378547);function ev(e){(0,c.useEffect)(()=>{(0,u.Z)("Cropper","/app/packages/Cropper/Cropper.tsx")},[]);let{children:a,cropArea:t,imageSize:n,objectDetection:i,onChange:l,previewCropArea:r,showPreviewArea:s,viewParameter:o,viewType:d}=e,p=(0,U.Z)(),m=(0,c.useRef)(null),h=(0,c.useRef)(null),[y,f]=(0,c.useState)(0),[_,x]=(0,c.useState)(0),[v,S]=(0,c.useState)(0),[b,k]=(0,c.useState)(0),[P,F]=(0,c.useState)((0,eh.Z)({cropArea:t,imageSize:n})),[C,R]=(0,c.useState)(null),[j,I]=(0,c.useState)(null),[T,E]=(0,c.useState)(!1),[Z,M]=(0,c.useState)(!1),D=e=>{e.preventDefault(),e.stopPropagation();let{clientX:a,clientY:t}=e,n=a-y,i=t-_;M(!1),S(n),k(i);let l=e.target,r=l.classList.contains("cropperHandle"),s="shadowMask"===l.id,o="cropSection"===l.id,d=l.id===ey.P,u=l.id===ex.I;r?(R("resize"),l.classList.contains("ne")?I("ne"):l.classList.contains("nw")?I("nw"):l.classList.contains("se")?I("se"):l.classList.contains("sw")?I("sw"):l.classList.contains("n")?I("n"):l.classList.contains("s")?I("s"):l.classList.contains("e")?I("e"):l.classList.contains("w")&&I("w")):s?(R("select"),F(er.OI)):o?R("move"):(P.x<n&&n<P.x+P.w&&P.y<i&&i<P.y+P.h?R("move"):(R("select"),F(er.OI)),E(d||u))},K=e=>{if(!C)return;E(!1);let{clientX:a,clientY:t}=e,i=a-y,l=t-_;if("resize"===C){let e=Math.max(Math.min(i,(n.width??1)-er.SP),er.SP),a=Math.max(Math.min(l,(n.height??1)-er.SP),er.SP),{x:t,y:r,w:s,h:o}=P;switch(j){case"ne":e<t&&a>r+o?I("sw"):e<t?I("nw"):a>r+o&&I("se");break;case"nw":e>t+s&&a>r+o?I("se"):e>t+s?I("ne"):a>r+o&&I("sw");break;case"se":e<t&&a<r?I("nw"):e<t?I("sw"):a<r&&I("ne");break;case"sw":e>t+s&&a<r?I("ne"):e>t+s?I("se"):a<r&&I("nw");break;case"n":a>r+o&&I("s");break;case"s":a<r&&I("n");break;case"e":e<t&&I("w");break;case"w":e>t+s&&I("e")}switch(j){case"ne":F(({x:t,y:n,h:i})=>{let l=Math.max(e-t,er.xZ),r=Math.max(i+(n-a),er.xZ);return{x:t,y:r<=er.xZ?n:a,w:l,h:r}});break;case"nw":F(({x:t,y:n,w:i,h:l})=>{let r=Math.max(i+(t-e),er.xZ),s=Math.max(l+(n-a),er.xZ);return{x:r===er.xZ?t:e,y:s===er.xZ?n:a,w:r,h:s}});break;case"se":F(({x:t,y:n})=>{let i=Math.max(e-t,er.xZ),l=Math.max(a-n,er.xZ);return{x:t,y:n,w:i,h:l}});break;case"sw":F(({x:t,y:n,w:i})=>{let l=Math.max(i+(t-e),er.xZ),r=Math.max(a-n,er.xZ);return{x:l===er.xZ?t:e,y:n,w:l,h:r}});break;case"n":F(({x:e,y:t,w:n,h:i})=>{let l=Math.max(t-a+i,er.xZ);return{x:e,y:l===er.xZ?t:a,w:n,h:l}});break;case"s":F(({x:e,y:t,w:n})=>{let i=Math.max(a-t,er.xZ);return{x:e,y:t,w:n,h:i}});break;case"e":F(({x:a,y:t,h:n})=>{let i=Math.max(e-a,er.xZ);return{x:a,y:t,w:i,h:n}});break;case"w":F(({x:a,y:t,w:n,h:i})=>{let l=Math.max(n-e+a,er.xZ);return{x:l===er.xZ?a:e,y:t,w:l,h:i}})}}else if("move"===C){let e=i-v,a=l-b,t=Math.max(Math.min(P.x+e,(n.width??1)-P.w-er.SP),er.SP),r=Math.max(Math.min(P.y+a,(n.height??1)-P.h-er.SP),er.SP);S(i),k(l),F(({w:e,h:a})=>({x:t,y:r,w:e,h:a}))}else if("select"===C){let e=Math.max(Math.min(i,n.width??1),0),a=Math.max(Math.min(l,n.height??1),0);F({x:Math.min(v,e),y:Math.min(b,a),w:Math.abs(e-v),h:Math.abs(a-b)})}},L=()=>{if(R(null),I(null),E(!1),C){if(T&&"dots"===i)return void M(!0);if(0===P.w&&0===P.h)l({cropArea:{x:er.SP,y:er.SP,w:(n.width??1)-2*er.SP,h:(n.height??1)-2*er.SP},cropSource:5}),p({event_type:16586,view_type:d,view_parameter:o});else{let e,a,t=Math.max(Math.min(P.x,(n.width??1)-er.xZ-er.SP),er.SP),i=Math.max(Math.min(P.y,(n.height??1)-er.xZ-er.SP),er.SP);e=P.h<er.xZ?er.xZ:i+P.h>(n.height??1)-er.SP?(n.height??1)-i-er.SP:P.h,a=P.w<er.xZ?er.xZ:t+P.w>(n.width??1)-er.SP?(n.width??1)-t-er.SP:P.w,"move"===C?p({event_type:7603,view_type:d,view_parameter:o}):"resize"===C?p({event_type:7604,view_type:d,view_parameter:o}):"select"===C&&p({event_type:16584,view_type:d,view_parameter:o}),l({cropArea:{x:t,y:i,w:a,h:e},cropSource:6})}}};return(0,e_.Z)(()=>{if(h.current){let{x:e,y:a}=h.current.getBoundingClientRect();f(e),x(a)}}),(0,c.useEffect)(()=>{Z&&F(t??er.OI)},[t,Z]),(0,c.useEffect)(()=>{let e=h.current;return e&&(e.addEventListener("mousedown",D),window.addEventListener("mousemove",K),window.addEventListener("mouseup",L)),()=>{e&&(e.removeEventListener("mousedown",D),window.removeEventListener("mousemove",K),window.removeEventListener("mouseup",L))}}),(0,w.jsxs)(g.xu,{ref:h,dangerouslySetInlineStyle:{__style:{cursor:"crosshair"}},"data-test-id":"visual-search-cropper",height:"100%",left:!0,position:"absolute",top:!0,width:"100%",children:[(0,w.jsx)(ef.Z,{unsafeCSS:er.iC}),(0,w.jsxs)("svg",{"data-gestalt-valid-html":"Box",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:[(0,w.jsx)("defs",{children:(0,w.jsxs)("mask",{id:"Mask",children:[(0,w.jsx)("rect",{fill:"white",height:n.height??"100%",rx:"0",ry:"0",width:n.width??"100%",x:"0",y:"0"}),(0,w.jsx)("rect",{height:P.h,id:"hole",rx:0,ry:0,width:P.w,x:P.x,y:P.y},`${P.x}${P.y}`),(0,w.jsx)(es.Z,{classNames:"preview-crop-area",in:s&&!C,mountOnEnter:!0,nodeRef:m,timeout:300,unmountOnExit:!0,children:(0,w.jsx)(g.xu,{ref:m,children:(0,w.jsx)("rect",{height:r.h,id:"preview",rx:4,ry:4,width:r.w,x:r.x,y:r.y},`${r.x}${r.y}`)})})]})}),(0,w.jsx)("rect",{fill:"rgba(0,0,0,0.5)",height:"100%",id:"shadowMask",mask:"url(#Mask)",width:"100%",x:"0",y:"0"}),(0,w.jsx)("use",{className:"v2cropSection","data-test-id":"cropper-section",fill:"rgba(0,0,0,0)",href:"#hole",id:"cropSection",stroke:"white",strokeWidth:"2",style:{cursor:"move"}})]}),a,(0,w.jsx)("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"},children:"select"!==C&&(0,w.jsx)(em,{h:P.h,w:P.w,x:P.x,y:P.y})})]})}var eS=t(941023),ew=t(359829),eb=t(74678),ek=t(556872),eP=t(611304);let eF=(void 0!==r||(r=t(584411)).hash&&"939d46d8644385a7918ed8179ce77a4c"!==r.hash&&console.error("The definition of 'UnauthCropperContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function eC({cropArea:e,customCropper:a,imageSignature:t,imageSize:n,pinKey:i,showAnimation:l,trafficSource:r,viewParameter:s,viewType:o}){(0,c.useEffect)(()=>{(0,u.Z)("UnauthCropperContainer","/app/packages/Flashlight/UnauthCropperContainer.tsx")},[]);let d=(0,m.Z)(eF,i),[p,g]=(0,c.useState)("none"),[h,y]=(0,c.useState)(!1),[f,_]=(0,c.useState)({x:0,y:0,w:0,h:0}),[x,v]=(0,c.useState)({isCropAreaOnDotArea:!1,indexToHide:-1}),{indexToHide:S}=x,b=(0,c.useMemo)(()=>(d.visualObjects??[]).filter(e=>e.isStela).map(eP.Z),[d.visualObjects]);return(0,c.useEffect)(()=>{let a=b&&!!b.length,t=(0,eb.Z)({cropArea:e,scaledHeight:n.height??0,scaledWidth:n.width??0});a&&(g("dots"),v((0,ew.Z)(b,t)))},[e,n.height,n.width,b]),(0,w.jsx)(ev,{cropArea:e,imageSize:n,objectDetection:p,onChange:a,previewCropArea:f,showPreviewArea:!1,viewParameter:s,viewType:o,children:"dots"===p&&(0,w.jsx)(eS.Z,{currentSpotlightIdx:S,handleSpotlightClick:e=>{let{x:t,y:i,w:l,h:s,title:o}=b[e];a({cropArea:(0,ek.Z)({cropArea:{x:t,y:i,w:l,h:s},scaledHeight:n.height??0,scaledWidth:n.width??0}),cropSource:4,trafficSource:r,title:o||""})},handleSpotlightHover:e=>{if(e===S)return;let{x:a,y:t,w:i,h:l}=b[e];_((0,ek.Z)({cropArea:{x:a,y:t,w:i,h:l},scaledWidth:n.width??0,scaledHeight:n.height??0})),y(!0)},handleSpotlightUnhover:()=>{y(!1)},imageSignature:t,imageSize:n,pinKey:d,showAnimation:l,viewParameter:s,viewType:o})},JSON.stringify(e))}var eR=t(506662),ej=t(728994),eI=t(123998),eT=t(572227),eE=t(351222),eZ=t(378888),eM=t(870358),eD=t(85363),eK=t(845421),eL=t(588836),eA=t(425140);let e$=0,eO="",eB=(void 0!==s||(s=t(579652)).hash&&"93612431e09eadc717c32d98e8d91e06"!==s.hash&&console.error("The definition of 'UnauthDesktopFlashlightPage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s);function eN(e){let{imageSpec_564x:a,imageSpec_orig:t,imageSignature:n}=e,i=a&&t,{url:l}=i??{},r=i?.width??1,s=i?.height??void 0;return"number"==typeof r&&"number"==typeof s&&r>564&&(s*=564/r,r=564),{width:r,height:s,url:l,imageSignature:n}}let ez=({data:e,index:a,viewParameter:t,productsURL:n})=>{switch(e.type){case"pin":return(0,w.jsx)(eK.Z,{duploQueryRef:null,pinId:e.id,slotIndex:a,viewParameter:t,viewType:72});case"story":return n&&(0,w.jsx)(Z,{dangerouslySetActionUrl:n,slotIndex:a,story:e});default:return null}},eU=({resourceOptions:e})=>{let a=(0,y.ZP)(),{data:t,isAtEnd:n,isFetching:i,fetchMore:l}=(0,f.Z)({name:"VisualLiveSearchResource",options:e}),r=(0,x.TH)(),s=`${r.pathname}products/${r.search}`;return(0,w.jsxs)(c.Fragment,{children:[t&&(0,w.jsx)(eA.Z,{customLayoutType:"desktopFlashlight",feedItems:t.results||[],feedKey:"flashlight-dweb-unauth",pagination:{loadNext:l,hasNext:n,isLoadingNext:i,refetch:()=>void 0},renderFeedItem:(e,a)=>ez({data:e,index:a,viewParameter:3050,productsURL:s})}),(0,w.jsx)(g.xH,{accessibilityLabel:a._('Loading visual search results...', 'unauthDesktopVisualSearch.flashlightFeed.loading', 'Accessibility label for loading visual search results'),show:i})]})},eW=({resourceOptions:e})=>{let a=(0,y.ZP)(),{data:t,isAtEnd:n,isFetching:i,fetchMore:l}=(0,f.Z)({name:"VisualLiveSearchProductFeedResource",options:e});return(0,w.jsxs)(c.Fragment,{children:[t&&(0,w.jsx)(eA.Z,{customLayoutType:"desktopFlashlight",feedItems:t||[],feedKey:"flashlight-products-dweb-unauth",pagination:{loadNext:l,hasNext:n,isLoadingNext:i,refetch:()=>void 0},renderFeedItem:(e,a)=>ez({data:e,index:a,viewParameter:3334})}),(0,w.jsx)(g.xH,{accessibilityLabel:a._('Loading visual search product results...', 'unauthDesktopVisualSearch.flashlightProductFeed.loading', 'Accessibility label for loading visual search product results'),show:i})]})};function eV({pinKey:e}){(0,c.useEffect)(()=>{(0,u.Z)("UnauthDesktopFlashlightPage","/app/www/VisualSearch/UnauthDesktopFlashlightPage.tsx")},[]);let a=(0,y.ZP)(),{isRTL:t}=(0,en.B)(),n=(0,U.Z)(),i=(0,x.s0)(),l=(0,x.TH)(),r=(0,c.useRef)(null),s=(0,p.$B)(),o=(0,eT.Z)(),{pinId:d}=(0,_.Z)(s.params.id||""),h=(0,eZ.mB)(l.search),f=(0,S.Z)(l),b=function(e){let a=parseInt(e??"",10);switch(a){case 1:case 2:case 3:case 4:case 5:case 6:return a;default:return}}(h.cropSource),k=(0,eR.hd)(l),P=(0,m.Z)(eB,e),{getNormalizedPinImage:F}=(0,ej.Z)({pinKey:P});if((0,c.useEffect)(()=>{if(!f&&P){let{width:e,height:a}=F();i((0,eD.Z)({cropArea:{h:a-2*er.SP,w:e-2*er.SP,x:er.SP,y:er.SP},isProductPage:k,pinId:d,surfaceType:"flashlight"}),{replace:!0})}},[F,i,f,k,P,d]),(0,e_.Z)(()=>{n({event_type:13,view_type:72,view_parameter:3050,view_data:{pin_id:d}})}),(0,c.useEffect)(()=>{let e=r.current;return e&&eO===d&&(e.scrollTop=e$),()=>{e&&(e$=e.scrollTop,eO=d)}}),!P)return(0,w.jsx)(eI.Z,{objectId:"",view:72,children:(0,w.jsx)(g.xu,{dangerouslySetInlineStyle:{__style:{top:eE.Pw}},position:"relative",children:(0,w.jsx)(g.xH,{accessibilityLabel:a._('Loading Pin data', 'unauthDesktopFlashlightPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0})})});let{imageSignature:C,description:R}=P,{width:j,height:I,url:T}=eN(P),E=function({initialCropArea:e,pin:a}){let t;if(e)t={...e};else{let{visualObjects:e}=a,{width:n=1,height:i=1}=eN(a);if(e&&e.length){let{x:a,y:l,w:r,h:s}=e[0];t=(0,ek.Z)({cropArea:{x:a,y:l,w:r,h:s},scaledWidth:n,scaledHeight:i})}else{let[e,a]=[n/6,i/6],[l,r]=[n-2*e,i-2*a];t={x:e,y:a,w:l,h:r}}}return{x:Math.floor(t.x??0),y:Math.floor(t.y??0),w:Math.floor(t.w??0),h:Math.floor(t.h??0)}}({initialCropArea:f,pin:P}),Z=l.state&&l.state.internalNavigation,M=j+v.n,D=(M??1)+24,K={pin_id:d,imageSignature:C,crop:(0,eb.Z)({cropArea:E,scaledWidth:j,scaledHeight:I}),crop_source:b||5},L={__style:{top:140}};return(0,w.jsx)(eI.Z,{objectId:"",view:72,children:(0,w.jsxs)(c.Fragment,{children:[(0,w.jsxs)(g.xu,{alignItems:"center",color:"default",dangerouslySetInlineStyle:{__style:{top:80}},display:"flex",height:60,position:"fixed",width:"100%",zIndex:new g.Ry(4),children:[!t&&(0,w.jsx)(g.xu,{left:!0,position:"absolute",children:(0,w.jsx)(eL.Z,{})}),(0,w.jsx)(g.xu,{flex:"grow",children:(0,w.jsx)(g.X6,{align:"center",size:"400",children:k?a._('Shop similar items', 'unauthDesktopFlashlightPage.flashlightProductsFeed.header', 'Header explaining results of flashlight products search'):a._('Visually similar results', 'unauthDesktopFlashlightPage.flashlightFeed.header', 'Header explaining results of flashlight search')})}),t&&(0,w.jsx)(g.xu,{position:"absolute",right:!0,children:(0,w.jsx)(eL.Z,{icon:"directional-arrow-left"})})]}),k?(0,w.jsx)(g.xu,{dangerouslySetInlineStyle:L,position:"relative",children:(0,w.jsx)(eW,{resourceOptions:K})}):(0,w.jsxs)(g.xu,{display:"flex",paddingX:12,children:[(0,w.jsxs)(g.xu,{ref:r,dangerouslySetInlineStyle:L,height:"calc(100% - 140px)",marginEnd:3,marginStart:3,overflow:"auto",position:"fixed",width:M,zIndex:new g.Ry(4),children:[(0,w.jsx)(g.xu,{dangerouslySetInlineStyle:{__style:{width:j,height:I}},"data-test-id":"flashlight-enabled-image",children:(0,w.jsxs)(g.zd,{height:I,rounding:2,width:j,children:[T&&(0,w.jsx)(g.Ee,{alt:R??"",naturalHeight:I??1,naturalWidth:j??1,src:T}),(0,w.jsx)(eC,{cropArea:E,customCropper:function({cropArea:e,cropSource:a}){let t=window.location.pathname+window.location.search,n=(0,eD.Z)({cropArea:e,cropSource:a??6,isProductPage:k,pinId:d,surfaceType:"flashlight"});o({action:"trigger",item:"cropper-changed",within:"flashlight-page"}),n!==t&&d&&i({pathname:`/pin/${d}/visual-search/`,search:(0,eM.Z)({cropArea:e,cropSource:a??6,surfaceType:"flashlight"})},{state:{internalNavigation:!0}})},imageSignature:C??void 0,imageSize:{height:I,width:j},pinKey:P,showAnimation:!Z,surfaceType:"flashlight",viewParameter:3050,viewType:72})]})}),(0,w.jsx)(g.xu,{"data-test-id":"closeupDescription",direction:"column",display:"flex",margin:5,maxWidth:j??1,position:"relative",children:(0,w.jsx)(el,{pageType:{isAuth:!1,page:"flashlight"},pinKey:P,viewportSize:"narrow"})})]}),(0,w.jsx)(g.xu,{dangerouslySetInlineStyle:{__style:{...L.__style,...t?{marginRight:`${D}px`}:{marginLeft:`${D}px`}}},position:"relative",width:"100%",children:(0,w.jsx)(eU,{resourceOptions:K})})]})]})})}let eG=(void 0!==o||(o=t(514336)).hash&&"01839fc3bcd9cdaf206873364167d157"!==o.hash&&console.error("The definition of 'UnauthDesktopFlashlightPageFetchData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o),eH=(void 0!==d||(d=t(165135)).hash&&"c1c702b23a1454b46f8e2fa9d8036257"!==d.hash&&console.error("The definition of 'UnauthDesktopFlashlightPageFetchDataPinQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),d);function eY(){let e=(0,p.$B)(),{pinId:a}=(0,_.Z)(e.params.id||""),t=(0,h.Z)({strategy:"Legacy",query:eH,variables:{pinId:a},useGetLegacyData:({pinId:e})=>(0,f.Z)({name:"PinResource",options:{id:e,field_set_key:"detailed",fetch_visual_search_objects:!0}}).data}),n=t?.v3GetPinQuery?.__typename==="V3GetPin"?t.v3GetPinQuery.data:null,i=(0,m.Z)(eG,n);return(0,w.jsx)(eV,{pinKey:i})}function eX(){(0,c.useEffect)(()=>{(0,u.Z)("UnauthDesktopFlashlightPageFetchData","/app/www/VisualSearch/UnauthDesktopFlashlightPageFetchData.tsx")},[]);let e=(0,y.ZP)();return(0,w.jsx)(c.Suspense,{fallback:(0,w.jsx)(g.xH,{accessibilityLabel:e._('Loading Pin data', 'unauthDesktopFlashlightPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0}),children:(0,w.jsx)(eY,{})})}},551651:function(e,a,t){t.d(a,{Z:()=>u});var n=t(281098),i=t(667294),l=t(346955),r=t(503246),s=t(706753),o=t(785893);class d extends i.Component{componentDidMount(){let{setCurrentPageData:e,viewData:a,viewParameter:t,viewType:n}=this.props;e({viewData:a,viewParameter:t,viewType:n})}componentDidUpdate(e){let{setCurrentPageData:a,viewData:t,viewParameter:n,viewType:i}=this.props;n===e.viewParameter&&i===e.viewType&&(0,r.ZP)(t,e.viewData)||a({viewData:t,viewParameter:n,viewType:i})}componentWillUnmount(){this.props.clearCurrentPageData()}render(){let{auxData:e,children:a,component:t,objectIdStr:n,viewData:i,viewParameter:l,viewType:r,clientTrackingParams:d}=this.props;return(0,o.jsx)(s.Z,{auxData:e,clientTrackingParams:d,component:t,objectIdStr:n,viewData:i,viewParameter:l,viewType:r,children:a})}}function u(e){(0,i.useEffect)(()=>{(0,n.Z)("PageView","/app/www/analytics/PageView.tsx")},[]);let{setViewContextData:a,clearViewContextData:t}=(0,l.A$)();return(0,o.jsx)(d,{...e,clearCurrentPageData:t,setCurrentPageData:a})}},706753:function(e,a,t){t.d(a,{Z:()=>r});var n=t(667294),i=t(521009),l=t(941404);function r(e){let{auxData:a,clientTrackingParams:t,children:r,component:s,element:o,objectIdStr:d,viewData:u,viewParameter:c,viewType:p}=e,g=(0,i.Z)(),m=JSON.stringify(a),h=JSON.stringify(u);return(0,n.useEffect)(()=>{(({viewType:e,viewParameter:a,viewData:t,auxData:n,objectIdStr:i,component:r,clientTrackingParams:s,element:o},d)=>{let u,c=Object.keys(u={event_type:13,view_type:e,view_parameter:a,view_data:t,aux_data:n,object_id_str:i,component:r,clientTrackingParams:s,element:o}).reduce((e,a)=>(void 0===u[a]&&delete e[a],e),{...u});-1===Object.keys(c).indexOf("view_type")&&(0,l.My)("mweb.logging.null_view_type"),d(c)})(e,g)},[g,m,t,s,o,d,h,c,p]),n.Children.only(r)}},305516:function(e,a,t){t.d(a,{Z:()=>ad});var n,i,l,r,s,o,d,u,c,p,g,m,h,y,f=t(281098),_=t(667294);t(167912);var x=t(616550),v=t(20256),S=t(355940),w=t(28427),b=t(801082),k=t(19585),P=t(900675),F=t(444185),C=t(634737),R=t(984126),j=t(825332),I=t(583270),T=t(258193),E=t(642407),Z=t(728994),M=t(378888),D=t(144633),K=t(74678),L=t(814685),A=t(330510),$=t(241646),O=t(980787),B=t(390843),N=t(163404),z=t(785893);function U({arrowType:e,viewParameter:a,viewType:t}){(0,_.useEffect)(()=>{(0,f.Z)("FlashlightBackButton","/app/common/react/components/discover/Flashlight/FlashlightBackButton.tsx")},[]);let n=(0,k.ZP)(),i=(0,j.s0)(),l=(0,j.TH)(),{previous:r}=(0,B.ou)(),{logContextEvent:s}=(0,O.u)(),o=(0,N.Z)(l.pathname);return(0,z.jsx)(v.xu,{"data-test-id":"go-back-button",children:(0,z.jsx)(v.hU,{accessibilityLabel:n._('Go back', 'Accessible icon for close button', 'Accessible icon for close button'),icon:e??"directional-arrow-left",iconColor:"darkGray",onClick:()=>{if(s({event_type:101,view_type:t,element:34,view_parameter:a}),0===r.length)return void i(`/pin/${o}/`,{replace:!0});i(-1)}})})}var W=t(37326),V=t(816358),G=t(645435);function H({isProductPage:e,title:a,viewParameter:t,viewType:n}){(0,_.useEffect)(()=>{(0,f.Z)("RelatedProductsHeader","/app/common/react/components/shopping/RelatedProducts/RelatedProductsHeader.tsx")},[]);let i=(0,_.useRef)(null);return(0,_.useEffect)(()=>(i.current&&V.Z.addObstruction("top",i.current),()=>{i.current&&V.Z.removeObstruction("top",i.current)})),(0,z.jsx)(G.Z,{position:e?"sticky":"fixed",shouldShowShadow:!0,children:(0,z.jsxs)(v.xu,{color:"default",dangerouslySetInlineStyle:{__style:{paddingBottom:"12px"}},display:"flex",justifyContent:"center",children:[(0,z.jsx)(v.xu,{alignItems:"center",display:"flex",height:48,left:!0,marginStart:5,position:"absolute",right:!0,width:48,children:(0,z.jsx)(U,{arrowType:a?"directional-arrow-left":"cancel",viewParameter:t,viewType:n})}),(0,z.jsx)(v.xu,{ref:i,alignItems:"center",color:"default","data-test-id":"related-products-header",display:"flex",height:48,children:(0,z.jsx)(W.Z,{title:a})})]})})}var Y=t(527895),X=t(761578),q=t(956077),Q=t(271910);function J({defaultPillColor:e,hoveredPillColor:a,pressedPillColor:t,isSelected:n,label:i,onTap:l,ref:r,selectedPillColor:s}){(0,_.useEffect)(()=>{(0,f.Z)("DescriptorPill","/app/www/Descriptors/DescriptorPill.tsx")},[]);let[o,d]=(0,_.useState)(e);return(0,_.useEffect)(()=>{d(n?s:e)},[n,s,e]),(0,z.jsx)(v.iP,{onMouseDown:()=>d(t),onMouseEnter:()=>{n||d(a)},onMouseLeave:()=>{n||d(e)},onTap:l,rounding:4,tapStyle:"compress",children:(0,z.jsx)(v.xu,{ref:r,dangerouslySetInlineStyle:{__style:{background:o}},"data-test-id":`descriptor-pill-${i}`,paddingX:4,paddingY:2,rounding:4,children:(0,z.jsx)(v.kC,{alignItems:"center",minHeight:32,children:(0,z.jsx)(v.mg,{color:n?"light":"dark",overflow:"noWrap",children:i})})})})}let ee=({showBackArrow:e,showFwdArrow:a,handleClickBack:t,handleClickForward:n})=>{(0,_.useEffect)(()=>{(0,f.Z)("DescriptorsNavigation","/app/www/Descriptors/DescriptorsNavigation.tsx")},[]);let i=(0,k.ZP)();return(0,z.jsxs)(v.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{pointerEvents:"none"}},"data-test-id":"descriptors-navigation-arrows",display:"flex",justifyContent:"between",left:!0,position:"absolute",right:!0,top:!0,children:[(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},marginStart:2,children:e&&(0,z.jsx)(v.hU,{accessibilityLabel:i._('Back', 'descriptor.navArrow.back', 'Accessibility label for a button that navigates back to previous search guides'),bgColor:"washLight",dataTestId:"descriptor-bar-back-button",icon:"arrow-back",onClick:t,size:"md"})}),(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},marginEnd:2,children:a&&(0,z.jsx)(v.hU,{accessibilityLabel:i._('Forward', 'descriptor.navArrow.forward', 'Accessibility label for a button that navigates forward to see more search guides'),bgColor:"washLight",dataTestId:"descriptor-bar-forward-button",icon:"arrow-forward",onClick:n,size:"md"})})]})};var ea=t(15667);let et=e=>`linear-gradient(to ${"left"===e?"right":"left"}, transparent, white 40px) intersect`,en=(void 0!==n||(n=t(500698)).hash&&"9d15639e8d9dd61426917dc218fbb3a6"!==n.hash&&console.error("The definition of 'Descriptors_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function ei({pressedPillColor:e,defaultPillColor:a,descriptorModules:t,hoveredPillColor:n,pinKey:i,selectedPillColor:l,isWebImageSearchRedesign:r}){(0,_.useEffect)(()=>{(0,f.Z)("Descriptors","/app/www/Descriptors/Descriptors.tsx")},[]);let[s,o]=(0,_.useState)(),[d,u]=(0,_.useState)(0),c=(0,j.s0)(),{search:p}=(0,j.TH)(),{barContainer:g,clientWidth:m,centerModules:h,offset:y,showBackArrow:x,showFwdArrow:S,handleClickForward:b,handleClickBack:k,onFocus:P,onMouseDown:F,scrollToPillByOffset:C}=(e=>{let a=(0,_.useRef)(null),{isRTL:t}=(0,ea.B)(),n=(0,_.useRef)(!1),[i,l]=(0,_.useState)(0),[r,s]=(0,_.useState)(0),[o,d]=(0,_.useState)(!1),[u,c]=(0,_.useState)(!1),{current:p}=a,{clientWidth:g=0,scrollWidth:m=0}=p??{},h=g||0,y=!!p&&h>=(m||0),f=e.length;(0,_.useEffect)(()=>{let e=p?.scrollWidth||0,a=0;Array.from(p?.children||[]).slice(0,i).forEach(e=>{a+=e.offsetWidth||0}),s(a=Math.min(a,e-g+8));let t=e-a,n=h>=e;n&&0!==i&&l(0),d(i>0&&!n),c(t>h&&i<f&&!n)},[p,i,f,h,t,g]);let x=(0,_.useCallback)(e=>{if(!p)return;let a=Array.from(p.children);if(e<0||e>=a.length)return;let t=0;a.slice(0,e).forEach(e=>{t+=e?.offsetWidth??0});let n=a[e]?.offsetWidth??0;if(t<r){s(t),l(e);return}if(t+n>r+g){s(t+n-g),l(e);return}l(e)},[p,r,g]),v=(0,_.useCallback)((e,a)=>{let t=e.current;if(!t||a<0||a>=t.length)return;let n=Array.from({length:a}).reduce((e,a,n)=>e+(t[n]?.offsetWidth??0),0),i=n+(t[a]?.offsetWidth??0);if(n>=r&&i<=r+g)return;let o=n<r?n:i-g;s(Math.max(0,Math.min(o,Math.max(0,m-g+8)))),l(Array.from({length:t.length}).reduce((e,a,n)=>{let{foundIndex:i,accWidth:l}=e;if(-1!==i)return e;let r=l+(t[n]?.offsetWidth??0);return{foundIndex:l>=o?n:-1,accWidth:r}},{foundIndex:-1,accWidth:0}).foundIndex)},[r,g,m]),S=(0,_.useCallback)(e=>{if("Tab"!==e.key)return;let a=Array.from(p?.children||[]),t=document.activeElement,n=a.findIndex(e=>e.contains(t));-1!==n&&(!e.shiftKey&&n<a.length-1?x(n+1):e.shiftKey&&n>0&&x(n-1))},[p,x]);return(0,_.useEffect)(()=>{if(p)return p.addEventListener("keydown",S,!0),()=>{p.removeEventListener("keydown",S,!0)}},[p,S]),{barContainer:a,centerModules:y,clientWidth:g,offset:r,showBackArrow:o,showFwdArrow:u,onFocus:()=>{n.current||l(i)},index:i,setIndex:l,handleClickForward:()=>{i+2<f?l(i+2):l(f-2)},handleClickBack:()=>{i-2>=0?l(i-2):l(0)},onMouseDown:()=>{n.current=!0},scrollToPillByOffset:v}})(t),R=(0,w.Z)(en,i),{logContextEvent:I}=(0,O.u)(),{descriptorsRefs:T}=((e,a,t,n,i)=>{let{logContextEvent:l}=(0,O.u)(),r=(0,_.useRef)([]),s=(0,_.useRef)([]);return(0,_.useEffect)(()=>{let o=0,d=r.current.map((n,i)=>{let l=n?.offsetWidth||0,r=o,s=o+l;o+=l+4;let{auxData:d}=t[i]||{auxData:{}},u=e+a,c=r+16>e&&r<u,p=s>e&&s-16<u;return{moduleId:d?.moduleId||"",isVisible:c||p}});d.forEach((e,a)=>{let t=s.current[a];if((!t||!1===t.isVisible)&&e.isVisible){let{auxData:e}=i||{};l({event_type:9993,view_type:72,view_parameter:3050,component:14047,aux_data:{image_signature:n||"",descriptor:e?.query}})}}),s.current=d},[r,e,a,t,l,n,i,s]),{descriptorsRefs:r}})(y,m,t,R.imageSignature||"",s);(0,_.useEffect)(()=>{if(void 0===s){let e=t.findIndex(e=>{let{display:a}=e,{isSelected:t}=a||{isSelected:!1};return t});-1!==e&&(o(t[e]),C(T,e))}},[t,s,C]),(0,_.useEffect)(()=>{u(r?(e=>{if(!e)return 0;let a=e.getBoundingClientRect(),t=window.innerHeight;return a.bottom>t?a.bottom-t:0})(g.current):0)},[g,r]);let{cropSource:E}=(0,M.mB)(p);if(!Number.isNaN(E)&&5!==Number(E))return null;let Z=e=>{let{id:a}=e,{id:t}=s||{};return null!=a&&t===a},D=[x?et("left"):"",S?et("right"):""].filter(Boolean).join(", ")||"none";return(0,z.jsx)(Q.q,{children:({hovered:i,onMouseEnter:r,onMouseLeave:u})=>(0,z.jsxs)(v.xu,{dangerouslySetInlineStyle:{__style:{bottom:d}},"data-test-id":"scrollable-descriptor-bar-root",left:!0,onMouseEnter:r,onMouseLeave:u,overflow:"hidden",position:"absolute",right:!0,children:[(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{mask:D}},children:(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{left:`-${y}px`,transition:"left 0.3s, right 0.3s"}},position:"relative",children:(0,z.jsx)(v.xu,{ref:g,display:"flex",justifyContent:h?"center":void 0,marginStart:2,paddingY:2,children:t.map((t,i)=>{let{action:r,display:s}=t,{feedUrl:d}=r||{};if(null==d)return null;let{displayText:u}=s||{};return(0,z.jsx)(v.xu,{marginEnd:1,onFocus:P,onMouseDown:F,children:(0,z.jsx)(J,{ref:e=>{T.current[i]=e},defaultPillColor:a,hoveredPillColor:n,isSelected:Z(t),label:u||"",onTap:()=>((e,a)=>{let t=Z(e),{action:n}=e,{feedUrl:i}=n||{};if(i)if(t){let e=i,{surfaceType:a}=(0,M.mB)(p);a&&(e=i.replace(RegExp(`^(.*surfaceType=${a}).*$`),"$1")),c(e??"",{replace:!0}),o(void 0)}else{let{surfaceType:t}=(0,M.mB)(p),n=i;t&&(n=i.replace(/(surfaceType=)[^&]*/,`$1${t}`)),c(n??"",{replace:!0}),C(T,a),o(e)}let{auxData:l}=e;I({event_type:102,view_type:72,view_parameter:3050,component:14047,aux_data:{image_signature:R.imageSignature||"",descriptor:l?.query}})})(t,i),pressedPillColor:e,selectedPillColor:l})},`descriptors-module-${t.id||i}`)})})})}),i&&(0,z.jsx)(ee,{handleClickBack:()=>{k();let{auxData:e}=s||{};I({event_type:108,view_type:72,view_parameter:3050,component:14046,aux_data:{image_signature:R.imageSignature||"",descriptor:e?.query}})},handleClickForward:()=>{b();let{auxData:e}=s||{};I({event_type:108,view_type:72,view_parameter:3050,component:14046,aux_data:{image_signature:R.imageSignature||"",descriptor:e?.query}})},showBackArrow:x,showFwdArrow:S})]})})}var el=t(790314);function er(e){return(0,_.useMemo)(()=>{let[a,t]=(0,el.Rn)({hexColor:e||"#FFFFFF",saturationMultiplier:3,brightnessMultiplier:1.6,minSaturationClamp:.15,mixVal:.3,minBrightnessClamp:0}),n=`rgba(${t[0]}, ${t[1]}, ${t[2]}, 0.95)`,i=`rgba(${a[0]}, ${a[1]}, ${a[2]}, 0.95)`,l=(0,el.e3)((0,el.rk)((0,el.t7)("rgba(117, 117, 112, 0.2)"),(0,el.t7)(n))),r=(0,el.e3)((0,el.rk)((0,el.t7)("rgba(117, 117, 112, 0.4)"),(0,el.t7)(n)));return{defaultColor:n,selectedColor:i,hoveredColor:l,pressedColor:r}},[e])}function es({defaultPillColor:e,hoveredPillColor:a,pressedPillColor:t,viewParameter:n,viewType:i}){(0,_.useEffect)(()=>{(0,f.Z)("VisualSearchCancelButton","/app/www/VisualSearch/VisualSearchCancelButton.tsx")},[]);let l=(0,k.ZP)(),r=(0,j.s0)(),s=(0,x.$B)(),{active:o,focused:d,hovered:u,onBlur:c,onFocus:p,onMouseDown:g,onMouseEnter:m,onMouseLeave:h,onMouseUp:y}=(0,Q.Z)(),{pinId:S}=(0,C.Z)(s.params.id||""),{previous:w}=(0,B.ou)(),{logContextEvent:b}=(0,O.u)();return(0,z.jsx)(v.xu,{"data-test-id":"go-back-button",children:(0,z.jsx)(v.iP,{onBlur:c,onFocus:p,onMouseDown:g,onMouseEnter:m,onMouseLeave:h,onMouseUp:y,onTap:()=>{if(b({event_type:101,view_type:i,element:34,view_parameter:n}),0===w.length)return void r(`/pin/${S}/`,{replace:!0});r(-1)},tapStyle:"compress",children:(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{background:o?t:d||u?a:e,backdropFilter:"blur(80px)"}},padding:3,rounding:4,children:(0,z.jsx)(v.JO,{accessibilityLabel:l._('Go back', 'imageSearch.cancelButton', 'Cancel button for going back to the Pin page'),color:"default",icon:"cancel",size:24})})})})}var eo=t(442212),ed=t(675973),eu=t(359829),ec=t(870358),ep=t(369416),eg=t(556872),em=t(665290),eh=t(341742),ey=t(281503);let ef=Math.ceil(40),e_=ef+1;function ex({isHidden:e,isObjectLevelCrop:a,isSelected:t,maskHeight:n,maskId:i,maskUrl:l,maskWidth:r,maskX:s,maskY:o}){(0,_.useEffect)(()=>{(0,f.Z)("CutoutGlow","/app/www/Cutouts/CutoutGlow.tsx")},[]);let{checkExperiment:d}=(0,ed.Z)(),u="enabled_once"===d("web_cutout_glow").group,{insetIntensity:c,debugMode:p,showHiddenCutoutsinDebug:g}=function(e){let a=e.split("_");return{insetIntensity:""===a[0]||Number.isNaN(Number(a[0]))?void 0:Number(a[0]),debugMode:a.includes("debug"),showHiddenCutoutsinDebug:a.includes("all")}}(d("web_cutout_glow_inset").group),m=`glow-sweep-${i}`,h=Math.round(.35*n),y=n/2+h/2,x=a?.25:.5,{svgElement:S,maskStyle:w}=(0,ey.Z)({debugMode:p,insetIntensity:c,kind:"glow",maskHeight:n,maskId:i,maskUrl:l,maskWidth:r});return(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{left:s,top:o,...w,visibility:t?"hidden":"visible"}},"data-test-id":"cutout-item",height:n,id:em.Ii,position:"absolute",width:r,children:(!e||g)&&(0,z.jsxs)(_.Fragment,{children:[S,(0,z.jsx)(ep.Z,{unsafeCSS:`
          @keyframes ${m} {
            0%                    { mask-position: 0 -${y}px; opacity: ${x}; }
            ${ef}% { mask-position: 0  ${y}px; opacity: ${x}; }
            ${e_}%      { mask-position: 0  ${y}px; opacity: 0; }
            100%                  { mask-position: 0 -${y}px; opacity: 0; }
          }`}),(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"none",animation:u?`${m} 5s linear forwards`:`${m} 5s linear infinite`,animationDelay:"1s",maskImage:`
              radial-gradient(
                ellipse ${4*h}px ${h}px at center,
                white 0%,
                white 15%,
                rgba(255, 255, 255, 0.9) 30%,
                rgba(255, 255, 255, 0.7) 45%,
                rgba(255, 255, 255, 0.5) 55%,
                rgba(255, 255, 255, 0.3) 65%,
                rgba(255, 255, 255, 0.15) 72%,
                rgba(255, 255, 255, 0.06) 80%,
                rgba(255, 255, 255, 0.01) 90%,
                transparent 100%
              )`,maskPosition:`0 -${y}px`,maskSize:"100% 100%",maskRepeat:"no-repeat"}},"data-test-id":"cutout-glow-oval",height:"100%",opacity:0,width:"100%",children:(0,z.jsx)(v.Ee,{alt:"cutout-glow-background-image",color:"white",fetchPriority:"high",fit:"cover",loading:"eager",naturalHeight:n,naturalWidth:r,role:"presentation",src:a?void 0:"https://s.pinimg.com/webapp/cutout-glow-background-23b2cec7.jpg"})})]})})}var ev=t(854146);let eS=(void 0!==i||(i=t(716125)).hash&&"f1b62436c05814e4188c8863a11dce6b"!==i.hash&&console.error("The definition of 'CutoutObject_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function ew({isHovered:e,isObjectLevelCrop:a,isPinLevelCrop:t,isSelected:n,mask:i,pinKey:l,viewParameter:r,viewType:s}){(0,_.useEffect)(()=>{(0,f.Z)("CutoutObject","/app/www/Cutouts/CutoutObject.tsx")},[]);let o=(0,A.D)(),{logContextEvent:d}=(0,O.u)(),u=(0,w.Z)(eS,l),{getNormalizedPinImage:c}=(0,Z.Z)({pinKey:u,maxWidth:o?L.M:E.Wm}),{height:p,width:g,url:m}=c(),{id:h,isHidden:y,maskHeight:x,maskUrl:v,maskWidth:S,maskX:b,maskY:k}=i;return(0,eh.Z)(()=>{y||d({event_type:120,element:14154,view_parameter:r,view_type:s,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}})}),(0,z.jsxs)(_.Fragment,{children:[(0,z.jsx)(ev.Z,{imageHeight:p,imageUrl:m,imageWidth:g,isHovered:e,isPinLevelCrop:t,isSelected:n,maskHeight:x,maskId:h,maskUrl:v,maskWidth:S,maskX:b,maskY:k}),(0,z.jsx)(ex,{isHidden:y,isObjectLevelCrop:a,isSelected:n,maskHeight:x,maskId:h,maskUrl:v,maskWidth:S,maskX:b,maskY:k})]})}let eb=(e,a,t)=>{let{maskX:n,maskY:i,maskWidth:l,maskHeight:r}=t;return e>=n&&e<=n+l&&a>=i&&a<=i+r},ek=(e,a,t)=>{if(a<0||t<0||a>=e.canvas.width||t>=e.canvas.height)return!1;try{let n=e.getImageData(a,t,1,1).data[0];return void 0!==n&&n>0}catch{return!1}},eP=e=>{let{id:a,mask_image:t,mask_bounds:n}=e;if(!a||!t||!n||2!==n.length)return!1;let[i,l]=n;if(!i||!l||2!==i.length||2!==l.length)return!1;let[r,s]=i,[o,d]=l;return[r,s,o,d].every(e=>"number"==typeof e&&!Number.isNaN(e))},eF=(void 0!==l||(l=t(431225)).hash&&"d2b8de09e9a0bd76025dff9de4c764e8"!==l.hash&&console.error("The definition of 'CutoutObjects_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function eC({bitmapMasks:e,hoveredCutoutIndex:a,imageContainerX:t,imageContainerY:n,pinKey:i,selectedCutoutIndex:l,setHoveredCutoutIndex:r,setSelectedCutoutIndex:s,trafficSource:o,viewParameter:d,viewType:u}){(0,_.useEffect)(()=>{(0,f.Z)("CutoutObjects","/app/www/Cutouts/CutoutObjects.tsx")},[]);let c=(0,A.D)(),{logContextEvent:p}=(0,O.u)(),g=(0,j.TH)(),m=(0,j.s0)(),h=(0,w.Z)(eF,i),{getNormalizedPinImage:y}=(0,Z.Z)({pinKey:h,maxWidth:c?L.M:E.Wm}),x=(0,_.useRef)(null),[S,b]=(0,_.useState)(!1),{w:k,h:P,cropSource:F}=(0,M.mB)(g.search),{height:C,width:R}=y(),I=(0,_.useMemo)(()=>Number(k)===R&&Number(P)===C||void 0===k&&void 0===P,[P,C,R,k]),T=(0,_.useMemo)(()=>9===Number(F),[F]),{cutoutContexts:D,maskData:K}=function(e,a,t){let[n,i]=(0,_.useState)([]),[l,r]=(0,_.useState)([]),[s,o]=(0,_.useState)(!1);return(0,_.useEffect)(()=>{let{maskData:n,urls:l}=e.reduce((e,n)=>{let i=((e,a,t)=>{if(!eP(e))return null;let{id:n,mask_image:i,mask_bounds:l,is_hidden:r}=e,[s,o]=l[0],[d,u]=l[1],c=(e=>{try{let a=atob(e),t=Uint8Array.from(a,e=>e.charCodeAt(0)),n=new Blob([t],{type:"image/png"});return URL.createObjectURL(n)}catch{return null}})(i);return c?{maskData:{id:n,isHidden:!!r,maskHeight:u*t,maskHeightRatio:u,maskUrl:c,maskWidth:d*a,maskWidthRatio:d,maskX:s*a,maskXRatio:s,maskY:o*t,maskYRatio:o},maskUrl:c}:null})(n,a,t);return i&&(e.maskData.push(i.maskData),e.urls.push(i.maskUrl)),e},{maskData:[],urls:[]});if(r(n),0===n.length)return i([]),o(!1),()=>l.forEach(e=>URL.revokeObjectURL(e));let s=!1;return o(!0),(async()=>{let e=n.map(async e=>{let a=document.createElement("canvas"),t=a.getContext("2d",{willReadFrequently:!0});if(!t)return null;let{maskWidth:n,maskHeight:i}=e;a.width=n,a.height=i;try{let a=new Image;return a.crossOrigin="anonymous",new Promise(l=>{a.onload=()=>{if(s)return void l(null);t.drawImage(a,0,0,n,i),l(t)},a.onerror=()=>l(null),a.src=e.maskUrl})}catch{return null}}),a=await Promise.all(e);s||(i(a),o(!1))})(),()=>{s=!0,l.forEach(e=>URL.revokeObjectURL(e))}},[e,a,t]),{cutoutContexts:n,maskData:l,isLoading:s}}(e,R,C),$=function({maskData:e,cutoutContexts:a,imageContainerX:t,imageContainerY:n,setHoveredCutoutIndex:i,viewParameter:l,viewType:r}){let{logContextEvent:s}=(0,O.u)(),{checkExperiment:o}=(0,ed.Z)(),{anyEnabled:d,group:u}=o("web_cutout_hit_detection_cache"),c="control"===u?1:"employees"===u?5:Number(u.split("_")[1]||5),p=(0,_.useRef)(new Map);(0,_.useEffect)(()=>{p.current.clear()},[e]);let g=(0,_.useCallback)((e,a)=>{e!==a&&(i(e),null!==e&&s({event_type:105,element:14154,view_parameter:l,view_type:r,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}}))},[i,s,l,r]);return(0,_.useCallback)((i,l,r)=>{let s=d?`${Math.round(i.clientX/c)*c},${Math.round(i.clientY/c)*c}`:"";if(d&&p.current.has(s))return void g(p.current.get(s)??null,l);let o=i.clientX-t,u=i.clientY-n;for(let t=e.length-1;t>=0;t-=1){let n=e[t],i=a[t];if(i&&n&&t!==r&&eb(o,u,n)&&ek(i,o-n.maskX,u-n.maskY)){d&&p.current.set(s,t),g(t,l);return}}d&&p.current.set(s,null),g(null,l)},[d,a,t,n,e,c,g])}({maskData:K,cutoutContexts:D,imageContainerX:t,imageContainerY:n,setHoveredCutoutIndex:r,viewParameter:d,viewType:u}),B=(0,_.useCallback)(()=>b(!1),[]),N=(0,_.useCallback)(e=>{(e.movementX||e.movementY)&&b(!0),0===e.buttons?$(e,a,l):r?.(null)},[$,a,l,r]),U=(0,_.useCallback)(e=>$(e,a,l),[$,a,l]),W=(0,_.useCallback)(()=>r(null),[r]),V=(0,_.useCallback)(()=>{if(S||null===a)return void b(!1);if(r(null),s(a),!K[a])return;let{maskXRatio:e,maskYRatio:t,maskWidthRatio:n,maskHeightRatio:i}=K[a],l=(0,eg.Z)({cropArea:{x:e,y:t,w:n,h:i},scaledWidth:R,scaledHeight:C}),c=(0,ec.Z)({cropArea:l,cropSource:9,trafficSource:o});window.location.search!==c&&(p({event_type:101,element:14154,view_parameter:d,view_type:u,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}}),m(`${window.location.pathname}${c}`,{replace:!0}))},[S,m,a,p,K,C,R,r,s,o,d,u]);return(0,_.useEffect)(()=>{let e=x.current;if(e)return e.addEventListener("mousedown",B),e.addEventListener("mousemove",N),e.addEventListener("mouseup",U),e.addEventListener("mouseleave",W),e.addEventListener("click",V),()=>{e.removeEventListener("mousedown",B),e.removeEventListener("mousemove",N),e.removeEventListener("mouseup",U),e.removeEventListener("mouseleave",W),e.removeEventListener("click",V)}},[B,N,U,W,V]),(0,z.jsxs)(v.xu,{ref:x,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:"number"==typeof a?"pointer":"auto"}},"data-bitmaps-ready":K.length>0,"data-test-id":"cutouts-container",left:!0,position:"absolute",right:!0,role:"none",top:!0,children:[(0,z.jsx)(ep.Z,{unsafeCSS:em.iF}),K.map((e,t)=>(0,z.jsx)(ew,{isHovered:a===t,isObjectLevelCrop:T,isPinLevelCrop:I,isSelected:l===t,mask:e,pinKey:h,viewParameter:d,viewType:u},e.id))]})}var eR=t(739067),ej=t(378547);let eI=(void 0!==r||(r=t(582328)).hash&&"2d79886cca650301394af9cbacdeede4"!==r.hash&&console.error("The definition of 'StelaCutouts_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function eT({bitmapMasks:e,hoveredCutoutIndex:a,imageContainerX:n,imageContainerY:i,pinImageHovered:l,pinKey:r,selectedCutoutIndex:s,setHoveredCutoutIndex:o,setSelectedCutoutIndex:d,trafficSource:u,viewParameter:c,viewType:p}){(0,_.useEffect)(()=>{(0,f.Z)("StelaCutouts","/app/www/Cutouts/StelaCutouts.tsx")},[]);let g=(0,A.D)(),m=(0,j.TH)(),{logContextEvent:h}=(0,O.u)(),y=(0,j.s0)(),x=(0,w.Z)(eI,r),{getNormalizedPinImage:S}=(0,Z.Z)({pinKey:x,maxWidth:g?L.M:E.Wm}),b=(0,_.useRef)(null),[k,P]=(0,_.useState)(!1),[F,C]=(0,_.useState)([]),[R,I]=(0,_.useState)(!1),[T,D]=(0,_.useState)(!1),{w:K,h:$}=(0,M.mB)(m.search),{height:B,width:N}=S(),U=(0,_.useMemo)(()=>Number(K)===N&&Number($)===B||void 0===K&&void 0===$,[$,B,N,K]),W=(0,_.useMemo)(()=>({commerce_data:JSON.stringify({pin_has_cutout:!0})}),[]);(0,_.useEffect)(()=>{if(!e)return;let a=[];async function n({id:e,isHidden:n,maskHeightRatio:i,maskImage:l,maskWidthRatio:r,maskXRatio:s,maskYRatio:o,pinImageHeight:d,pinImageWidth:u}){let{ContourTracer:c,initializeWasm:p}=await t.e("95563").then(t.bind(t,193386));await p();let g=new c,m=atob(l),h=new Blob([Uint8Array.from(m,e=>e.charCodeAt(0))],{type:"image/png"}),y=await createImageBitmap(h),f=g.trace(y,{useAlpha:!1,threshold:80}),_=URL.createObjectURL(h);return a.push(_),{contours:f,contourXRatio:u*r/y.width,contourYRatio:d*i/y.height,id:e,isHidden:n,maskHeightRatio:i,maskUrl:_,maskWidthRatio:r,maskXRatio:s,maskYRatio:o}}let i=[];return e.forEach(e=>{let{id:a,mask_image:t,mask_bounds:l,is_hidden:r}=e,[s,o]=l?.[0]??[],[d,u]=l?.[1]??[];if(void 0!==a&&void 0!==t&&void 0!==s&&void 0!==o&&void 0!==d&&void 0!==u){let e=n({id:a,isHidden:!!r,maskHeightRatio:u,maskImage:t,maskWidthRatio:d,maskXRatio:s,maskYRatio:o,pinImageHeight:B,pinImageWidth:N});i.push(e)}}),(async()=>{C(await Promise.all(i))})(),()=>{a.forEach(e=>{URL.revokeObjectURL(e)})}},[e,B,N]);let V=(0,_.useMemo)(()=>{let e=[];return F.forEach((a,t)=>{let{contours:n}=a;n&&0!==n.length&&(e[t]=n.map(e=>{let a=e.points.map(e=>e.x),t=e.points.map(e=>e.y);return{minX:Math.min(...a),minY:Math.min(...t),maxX:Math.max(...a),maxY:Math.max(...t)}}))}),e},[F]),G=(0,_.useCallback)(e=>{let t=e.clientX-n,l=e.clientY-i;for(let e=F.length-1;e>=0;e-=1){let n=F[e];if(e===s||!n)continue;let{contours:i,contourXRatio:r,contourYRatio:d,maskXRatio:u,maskYRatio:g}=n,m=(t-u*N)/r,y=(l-g*B)/d,f=V[e];if(i.some((e,a)=>{let t=f?.[a];return t&&m>=t.minX&&m<=t.maxX&&y>=t.minY&&y<=t.maxY&&(0,eR.Z)({x:m,y:y},e.points)})){a!==e&&(o?.(e),h({event_type:105,element:14154,view_parameter:c,view_type:p,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}}));return}}o?.(null)},[F,V,a,n,i,h,B,N,s,o,c,p]),H=()=>P(!1),Y=e=>{(e.movementX||e.movementY)&&P(!0),0===e.buttons?G(e):o?.(null)},X=e=>{G(e)},q=()=>o?.(null),Q=(0,_.useCallback)(()=>{if(k||null===a||!F[a])return void P(!1);d?.(a);let{maskXRatio:e,maskYRatio:t,maskWidthRatio:n,maskHeightRatio:i}=F[a],l=(0,eg.Z)({cropArea:{x:e,y:t,w:n,h:i},scaledWidth:N,scaledHeight:B}),r=(0,ec.Z)({cropArea:l,cropSource:9,trafficSource:u});r!==window.location.search&&(h({event_type:101,element:14154,view_parameter:c,view_type:p,aux_data:W}),y(`${window.location.pathname}${r}`,{replace:!0}))},[W,F,k,y,a,h,B,N,d,u,c,p]);return((0,_.useEffect)(()=>{let e=b.current;return e&&(e.addEventListener("mousedown",H),e.addEventListener("mousemove",Y),e.addEventListener("mouseup",X),e.addEventListener("mouseleave",q),e.addEventListener("click",Q)),()=>{e&&(e.removeEventListener("mousedown",H),e.removeEventListener("mousemove",Y),e.removeEventListener("mouseup",X),e.removeEventListener("mouseleave",q),e.removeEventListener("click",Q))}}),e)?(0,z.jsxs)(v.xu,{ref:b,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:"number"==typeof a?"pointer":"auto"}},"data-bitmaps-ready":F.length>0,"data-test-id":"cutouts-container",left:!0,position:"absolute",right:!0,role:"none",top:!0,children:[(0,z.jsx)(ep.Z,{unsafeCSS:em.iF}),F.map((e,t)=>(0,z.jsx)(ej.Z,{auxData:W,bitmapData:e,hasAnimatedCutoutsOnLand:T,hasLoggedRender:R,hoveredCutoutIndex:a,index:t,isPinLevelCrop:U,pinImageHovered:l,pinKey:x,selectedCutoutIndex:s,setHasAnimatedCutoutsOnLand:D,setHasLoggedRender:I,viewParameter:c,viewType:p},e.id))]}):null}var eE=t(68408);let eZ=(void 0!==s||(s=t(934209)).hash&&"66496d579d49595f2dec36d1c939738c"!==s.hash&&console.error("The definition of 'VisualSearchCropper_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s);function eM({cropArea:e,cropSource:a,imageContainerX:t=0,imageContainerY:n=0,imageSize:i,onMouseDown:l,onMouseMoveSetCropArea:r,pinKey:s,trafficSource:o,viewParameter:d,viewType:u}){(0,_.useEffect)(()=>{(0,f.Z)("VisualSearchCropper","/app/www/VisualSearch/VisualSearchCropper.tsx")},[]);let{checkExperiment:c}=(0,ed.Z)(),p=(0,w.Z)(eZ,s),g=(0,j.s0)(),m=(0,eE.Z)({pinKey:p}),[h,y]=(0,_.useState)("none"),[x,v]=(0,_.useState)(null),[S,b]=(0,_.useState)(-1),{bitmap_masks:k}=m??{},P=(0,_.useMemo)(()=>(k??[]).filter(eP).map(e=>{let{id:a,mask_bounds:t}=e,[n,i]=t[0],[l,r]=t[1];return{x:n,y:i,w:l,h:r,id:a}}),[k]);return(0,_.useEffect)(()=>{let a=(0,K.Z)({cropArea:e,scaledHeight:i.height??0,scaledWidth:i.width??0});if(P&&P.length){let e=(0,eu.Z)(P,a);y("cutouts"),b(e.indexToHide)}},[e,P,i.height,i.width]),(0,z.jsx)(eo.Z,{cropArea:e,cropSource:a,hoveredCutoutIndex:x,imageContainerX:t,imageContainerY:n,imageSize:i,objectDetection:h,onChange:({cropArea:e,cropSource:a})=>{if("cutouts"===h){let t=(0,K.Z)({cropArea:e,scaledHeight:i.height??0,scaledWidth:i.width??0}),{isCropAreaOnDotArea:n,indexToHide:l}=(0,eu.Z)(P,t);n&&(a=9,b?.(l))}let t=window.location.search,n=(0,ec.Z)({cropArea:e,cropSource:a,trafficSource:o});t!==n&&g({pathname:window.location.pathname,search:n},{replace:!0})},onMouseDown:l,onMouseMoveSetCropArea:r,setHoveredCutoutIndex:v,setSelectedCutoutIndex:b,viewParameter:d,viewType:u,children:(()=>{if("cutouts"!==h||!k?.length)return null;let{anyEnabled:e}=c("web_cutout_glow");return(0,z.jsx)(e?eC:eT,{bitmapMasks:k,hoveredCutoutIndex:x,imageContainerX:t,imageContainerY:n,pinKey:p,selectedCutoutIndex:S,setHoveredCutoutIndex:v,setSelectedCutoutIndex:b,trafficSource:o,viewParameter:d,viewType:u})})()})}let eD=(void 0!==o||(o=t(984110)).hash&&"727c8ab2c1c256e3b4478a36890f92d6"!==o.hash&&console.error("The definition of 'RelatedProductsImageContent_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o);function eK({cropArea:e,cropSource:a,description:t,descriptorModules:n,height:i,imageContainerX:l,imageContainerY:r,imageUrl:s,pinKey:o,trafficSource:d,viewParameter:u,viewType:c,width:p}){(0,_.useEffect)(()=>{(0,f.Z)("RelatedProductsImageContent","/app/common/react/components/shopping/RelatedProducts/RelatedProductsImageContent.tsx")},[]);let g=(0,A.D)(),m=(0,w.Z)(eD,o),{defaultColor:h,selectedColor:y,hoveredColor:x,pressedColor:S}=er(m.dominantColor),{height:b=0}=(0,X.Z)()||{},k=r+i,P=k>b,F=P?Math.min(k-64-12,b-64-12):i-64;return(0,z.jsxs)(v.xu,{"data-test-id":"flashlight-enabled-image",height:i,width:p,children:[(0,z.jsxs)(v.zd,{height:i,rounding:g?6:4,width:p,children:[(0,z.jsx)(Y.Z,{_enableViewTransitions:!0,type:"image",children:(0,z.jsx)(v.Ee,{alt:t,naturalHeight:i,naturalWidth:p,onLoad:()=>{(0,q.Nx)("visualSearchMainPinImageRender")},src:s})}),(0,z.jsx)(eM,{cropArea:e,cropSource:a,imageContainerX:l,imageContainerY:r,imageSize:{height:i,width:p},pinKey:m,trafficSource:d,viewParameter:u,viewType:c}),g&&(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{insetInlineStart:0}},position:"absolute",top:!0,children:(0,z.jsx)(es,{defaultPillColor:h,hoveredPillColor:x,pressedPillColor:S,viewParameter:u,viewType:c})})]}),n&&n.length>0&&(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{top:F}},height:64,position:P?"fixed":"absolute",width:p,children:(0,z.jsx)(ei,{defaultPillColor:h,descriptorModules:n,hoveredPillColor:x,pinKey:m,pressedPillColor:S,selectedPillColor:y})})]})}var eL=t(742235),eA=t(780879),e$=t(721465),eO=t(288910);let eB=(void 0!==d||(d=t(758809)).hash&&"20c2c7f4ff982fb93a9608faa14f3ed2"!==d.hash&&console.error("The definition of 'RelatedProductsUnifiedFeed_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),d);function eN({alignStart:e,auxData:a,isFilterOpened:t,isProductOnlyFeed:n,oneBarModules:i,pinKey:l,viewParameter:r,viewType:s,visualSearchFlashlightUnifiedResource:o}){(0,_.useEffect)(()=>{(0,f.Z)("RelatedProductsUnifiedFeed","/app/common/react/components/shopping/RelatedProducts/UnifiedFeed/RelatedProductsUnifiedFeed.tsx")},[]);let d=(0,w.Z)(eB,l),u=!n&&i&&i.length>0,{data:c}=o,p=c?.search_identifier;return(0,z.jsxs)(_.Fragment,{children:[u&&(0,z.jsx)(v.xu,{position:"relative",zIndex:new v.Ry(1),children:(0,z.jsx)(eO.v,{children:(0,z.jsx)(eA.f,{children:(0,z.jsx)(eL.default,{oneBarModulesKey:null,oneBarModulesRest:i,paddingX:8})})})}),(0,z.jsx)(v.xu,{overflow:"hidden",children:(0,z.jsx)(e$.Z,{alignStart:e,auxData:a,isFilterOpened:t,isProductFeed:n,pinKey:d,searchId:p,viewParameter:r,viewType:s,visualSearchFlashlightUnifiedResource:o})})]})}var ez=t(449029),eU=t(140725),eW=t(93966),eV=t(123998);function eG({cropSource:e}){return{viewType:72,viewParameter:9===e?3462:3050}}var eH=t(230543),eY=t(74459);let eX=(void 0!==u||(u=t(829187)).hash&&"3a9a747c3135f426fe0cf32ca9147a5d"!==u.hash&&console.error("The definition of 'VisualSearchContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),u);function eq({cropArea:e,cropSource:a,isProductPage:t,oneBarModules:n,pinKey:i,searchId:l,descriptorModules:r,title:s,trafficSource:o,visualSearchFlashlightUnifiedResource:d}){(0,_.useEffect)(()=>{(0,f.Z)("VisualSearchContainer","/app/www/VisualSearch/VisualSearchContainer.tsx")},[]);let u=(0,w.Z)(eX,i),{getNormalizedPinImage:c}=(0,Z.Z)({pinKey:u,maxWidth:E.Wm}),p=(0,j.TH)(),{width:g=0}=(0,X.Z)()||{},m=(0,eH.t)(),h=(0,eY.Z)(),{imageContainerScrollTop:y,imageContainerScrollTopForPinId:x}=(0,ez._)(),S=(0,_.useRef)(null),[b,k]=(0,_.useState)(0),[P,F]=(0,_.useState)(0),{state:C}=p||{},{internalNavigation:R=!1}=C||{},{width:I,height:T,url:M}=c(),D=I+$.n,K=t?0:D+48,L=g-h-K-$.n,{viewType:A,viewParameter:O}=eG({cropSource:a}),B={commerce_data:JSON.stringify({is_product_only_feed:t})},N=()=>{let e=S.current;if(e){let{x:a,y:t}=e.getBoundingClientRect(),{scrollTop:n}=e;k(a),F(t-n)}};return(0,eh.Z)(()=>{N(),S.current&&0!==y.current&&x.current===u.entityId&&(S.current.scrollTop=y.current)}),(0,z.jsx)(eV.Z,{objectId:l,view:A,children:(0,z.jsx)(eU.Z,{log:{aux_data:B,view_type:A,view_parameter:O},children:(0,z.jsxs)(v.xu,{"data-test-id":"related-products",children:[(0,z.jsx)(H,{isProductPage:t,title:t?s:"",viewParameter:O,viewType:A}),!t&&(0,z.jsx)(v.xu,{ref:S,bottom:!0,dangerouslySetInlineStyle:{__style:{top:m+80,left:h,right:h}},height:"inherit",marginBottom:3,marginStart:12,onScroll:()=>{N(),y.current=S.current?.scrollTop||0,x.current=u.entityId},overflow:"auto",position:"fixed",width:D,children:(0,z.jsx)(eK,{cropArea:e,cropSource:a,description:u.description??"",descriptorModules:r,height:T,imageContainerX:b,imageContainerY:P,imageSignature:u.imageSignature||"",imageUrl:M,pinKey:u,showAnimation:!R,trafficSource:o,viewParameter:O,viewType:A,width:I})}),(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{top:80*!t,left:K,right:K}},paddingX:eW.jC,position:"relative",width:L,children:(0,z.jsx)(eN,{auxData:B,isProductOnlyFeed:t,oneBarModules:n,pinKey:u,viewParameter:O,viewType:A,visualSearchFlashlightUnifiedResource:d})})]})})})}var eQ=t(762525),eJ=t(469167),e0=t(355363),e1=t(159527),e2=t(845421),e5=t(816533),e6=t(757947),e3=t(162903);let e4=(void 0!==c||(c=t(172359)).hash&&"f426019c8f8e2668ff17a413d85a72dd"!==c.hash&&console.error("The definition of 'VisualSearchCarousel_story' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),c);function e8({auxData:e,hasActionCTA:a,legacyStory:t,searchIdentifier:n,storyKey:i,trafficSource:l,viewParameter:r,viewType:s}){(0,_.useEffect)(()=>{(0,f.Z)("VisualSearchCarousel","/app/www/VisualSearch/VisualSearchCarousel.tsx")},[]);let o=(0,x.TH)(),d=(0,w.Z)(e4,i),u=(0,_.useCallback)(({item:t,index:i})=>{if(a&&d.objects&&i===d.objects.length-1){let a=t.images?.["236x"]?.url,n=o.pathname+"products/"+o.search;return a&&(0,z.jsx)(e6.Z,{auxData:e,buttonText:d.action?.text||"See more",component:14339,dataTestId:"shop-action-item-button",element:179,imageWidth:e5.Z,previewImageSrc:a,storyId:d.storyId??void 0,storyType:d.storyType,url:n,view:s,viewParameter:r})}return(0,z.jsx)(e2.r,{auxData:e,componentType:14339,isInDesktopCarousel:!0,pinId:t.id||"",pinImageCrop:{width:e5.Z,height:e5.Z},pinKey:null,slotIndex:i,surface:"VisualInspirationShoppingPin",trafficSource:l,viewData:{search_identifier:n},viewParameter:r,viewType:s})},[a,d.objects,d.action?.text,d.storyId,d.storyType,e,l,n,r,s,o.pathname,o.search]),c=t?.objects?.filter(e=>"pin"===e.type);return c&&0!==c.length?(0,z.jsx)(e3.Z,{items:c,itemWidth:e5.Z,renderItem:u,showBorder:!0,storyKey:d,view:s,viewParameter:r}):null}function e7({auxData:e,isProductOnlyFeed:a,oneBarModules:t,trafficSource:n,viewParameter:i,viewType:l,visualSearchFlashlightUnifiedResource:r}){(0,_.useEffect)(()=>{(0,f.Z)("VisualSearchFeed","/app/www/VisualSearch/VisualSearchFeed.tsx")},[]);let s=(0,k.ZP)(),{logContextEvent:o}=(0,O.u)(),d=(0,_.useRef)(!1),u=(0,_.useRef)(null),c=!a&&t&&t.length>0,{data:p,isFetching:g,fetchMore:m,isAtEnd:h}=r,{results:y=[],search_identifier:x}=p||{},{action:S,objects:w}=y.find(e=>"story"===e.type&&"stela_shop"===e.story_type)||{},{text:b,url:P}=S||{},F=w?.length||0,C=!!(b&&P),R=(0,e1.Z)(()=>{d.current||(o({event_type:110,view_type:l,view_parameter:i}),d.current=!0)},1e3),j=(0,_.useCallback)(({data:t,itemIdx:r})=>{if("story"===t.type)return"unified_entry_point_flashlight_header"===t.story_type?null:(0,z.jsx)(e8,{auxData:e,hasActionCTA:C,legacyStory:t,searchIdentifier:x,storyKey:{type:"Legacy",data:t},trafficSource:n,viewParameter:i,viewType:l});if("pin"===t.type){let s=r+F-!!C;return(0,z.jsx)(e2.r,{auxData:e,componentType:0,pinId:t.id,pinKey:null,slotIndex:s,surface:a?"ShoppingDynamicHeightGrid":"SearchItem",trafficSource:n,viewData:{search_identifier:x},viewParameter:i,viewType:l})}return null},[e,x,n,l,i,C,F,a]),I=(0,_.useCallback)(e=>"story"!==e.type,[]);return(0,z.jsxs)(_.Fragment,{children:[c&&(0,z.jsx)(G.Z,{position:"sticky",shouldShowShadow:!0,children:(0,z.jsx)(eO.v,{children:(0,z.jsx)(eA.f,{children:(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{paddingInlineEnd:"8px"}},children:(0,z.jsx)(eL.default,{itemHeight:48,marginBottom:0,oneBarModulesKey:null,oneBarModulesRest:t,paddingBottom:12,paddingX:3})})})})}),(0,z.jsx)(v.xu,{ref:u,"data-test-id":"visual-search-feed",onScroll:R,overflow:"hidden",children:(0,z.jsx)(e0.Z,{isAtEndOfFeed:h,itemCount:y.length,children:(0,z.jsx)(eJ.default,{align:a?"center":"start",getColumnSpanConfig:e=>{let a="story"===e.type&&e.display_options?.num_columns_requested;return 0===a?1/0:a||1},isFetching:g,isLoadedAccessibilityLabel:s._('Visual search results loaded', 'visualSearch.masonry.loaded.label', 'Accessibility label when masonry has finished loading'),isLoadingAccessibilityLabel:s._('Loading visual search results', 'visualSearch.masonry.loading.label', 'Accessibility label for masonry loading state'),isLoadingStateEnabled:!0,items:y,layout:"basic",loadItems:m,minCols:1,renderItem:j,scrollContainer:()=>u.current??window,virtualize:I})})})]})}let e9=(void 0!==p||(p=t(922081)).hash&&"355940c4e98c8536ca89baf5b758fce5"!==p.hash&&console.error("The definition of 'VisualSearchImageContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),p);function ae({cropArea:e,cropSource:a,descriptorModules:t,pinKey:n,trafficSource:i,viewParameter:l,viewType:r}){(0,_.useEffect)(()=>{(0,f.Z)("VisualSearchImageContainer","/app/www/VisualSearch/VisualSearchImageContainer.tsx")},[]);let s=(0,w.Z)(e9,n),{getNormalizedPinImage:o}=(0,Z.Z)({pinKey:s,maxWidth:L.M}),d=(0,eH.t)(),u=(0,eY.Z)(),{imageContainerScrollTop:c,imageContainerScrollTopForPinId:p}=(0,ez._)(),g=(0,_.useRef)(null),[m,h]=(0,_.useState)(0),[y,x]=(0,_.useState)(0),[S,b]=(0,_.useState)(0),{defaultColor:k,selectedColor:P,hoveredColor:F,pressedColor:C}=er(s.dominantColor),{setScrollAvailability:R,scrollCropperInView:j}=function({scrollContainerRef:e,imageY:a}){let t=(0,eH.t)(),n=(0,_.useRef)(!1),i=(0,_.useRef)(!0),l=(0,_.useCallback)(e=>t-a-(e-E.SP),[t,a]),r=(0,_.useCallback)(e=>{l(e)>0?(n.current=!0,i.current=!1):(n.current=!1,i.current=!0)},[l]),s=(0,_.useCallback)(a=>{if(!e.current||0===e.current.scrollTop)return;let t=l(a);n.current&&t<=0&&(n.current=!1,i.current=!0),i.current&&t>0&&(e.current.scrollTop-=t)},[l,e]);return{setScrollAvailability:r,scrollCropperInView:(0,_.useMemo)(()=>(0,e1.Z)(s,16),[s])}}({scrollContainerRef:g,imageY:y}),I=(0,_.useCallback)(()=>(0,q.Nx)("visualSearchMainPinImageRender"),[]),{width:T,height:M,url:D}=o(),K=T+16,A=t&&t.length>0,$=64*!!A,O=(0,_.useCallback)(()=>{let e=g.current;if(e){let{x:a,y:t}=e.getBoundingClientRect(),{scrollTop:n}=e;h(a),x(t-n)}b(16*(M>=window.innerHeight-d&&!A))},[d,M,A]),B=(0,_.useCallback)(()=>{O(),c.current=g.current?.scrollTop||0,p.current=s.entityId},[O,s.entityId,c,p]);return(0,eh.Z)(()=>{let e=c.current,a=p.current;g.current&&0!==e&&a===s.entityId&&(g.current.scrollTop=e),O()}),(0,z.jsxs)(_.Fragment,{children:[(0,z.jsx)(v.xu,{ref:g,bottom:!0,dangerouslySetInlineStyle:{__style:{top:d,insetInlineStart:u,height:`min(${M}px, calc(100vh - ${d}px))`,paddingBottom:`${S}px`}},"data-test-id":"visual-search-image-container",marginStart:3,onScroll:B,overflow:"auto",position:"fixed",width:K,children:(0,z.jsx)(v.xu,{"data-test-id":"flashlight-enabled-image",height:M+$,width:T,children:(0,z.jsxs)(v.zd,{height:M,rounding:6,width:T,children:[(0,z.jsx)(Y.Z,{_enableViewTransitions:!0,type:"image",children:(0,z.jsx)(v.Ee,{alt:s.description??"",naturalHeight:M,naturalWidth:T,onLoad:I,src:D})}),(0,z.jsx)(eM,{cropArea:e,cropSource:a,imageContainerX:m,imageContainerY:y,imageSize:{height:M,width:T},onMouseDown:R,onMouseMoveSetCropArea:j,pinKey:s,trafficSource:i,viewParameter:l,viewType:r})]})})}),(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{top:d,insetInlineStart:u}},"data-test-id":"visual-search-cancel-button-container",marginStart:5,marginTop:2,position:"fixed",children:(0,z.jsx)(es,{defaultPillColor:k,hoveredPillColor:F,pressedPillColor:C,viewParameter:l,viewType:r})}),A&&(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{top:`min(${d+M-64}px, calc(100vh - 64px))`,insetInlineStart:u}},"data-test-id":"visual-search-descriptor-container",height:64,marginStart:3,position:"fixed",width:T,children:(0,z.jsx)(ei,{defaultPillColor:k,descriptorModules:t,hoveredPillColor:F,isWebImageSearchRedesign:!0,pinKey:s,pressedPillColor:C,selectedPillColor:P})}),(0,z.jsx)(v.xu,{dangerouslySetInlineStyle:{__style:{boxSizing:"content-box"}},"data-test-id":"visual-search-image-container-placeholder",height:1,marginStart:3,minWidth:K})]})}let aa=(void 0!==g||(g=t(331921)).hash&&"3c3f391c3bf9eec79c18ed9a3fe63800"!==g.hash&&console.error("The definition of 'VisualSearchLayout_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),g);function at({cropArea:e,cropSource:a,isProductPage:t,oneBarModules:n,pinKey:i,searchId:l,descriptorModules:r,trafficSource:s,visualSearchFlashlightUnifiedResource:o}){(0,_.useEffect)(()=>{(0,f.Z)("VisualSearchLayout","/app/www/VisualSearch/VisualSearchLayout.tsx")},[]);let d=(0,w.Z)(aa,i),u=(0,k.ZP)(),c=u._('Shop similar', 'visualSearch.productPage.header', 'Shop similar visual searched items.'),{viewType:p,viewParameter:g}=eG({cropSource:a}),m={commerce_data:JSON.stringify({is_product_only_feed:t})};return(0,z.jsx)(eV.Z,{objectId:l,view:p,children:(0,z.jsxs)(eU.Z,{log:{aux_data:m,view_type:p,view_parameter:g},children:[t?(0,z.jsx)(H,{isProductPage:!0,title:c,viewParameter:g,viewType:p}):(0,z.jsx)(eQ.Z,{text:u._('Image Search Page', 'imageSearch.accessibilityHiddenHeading', 'Accessibility label for image search page')}),(0,z.jsxs)(v.kC,{children:[!t&&(0,z.jsx)(ae,{cropArea:e,cropSource:a,descriptorModules:r,pinKey:d,trafficSource:s,viewParameter:g,viewType:p}),(0,z.jsx)(v.kC.Item,{flex:"grow",children:(0,z.jsx)(e7,{auxData:m,isProductOnlyFeed:t,oneBarModules:n,trafficSource:s,viewParameter:g,viewType:p,visualSearchFlashlightUnifiedResource:o})})]})]})})}let an=(void 0!==m||(m=t(553593)).hash&&"a97627ca011ed4139267bc5a970d6d7a"!==m.hash&&console.error("The definition of 'VisualSearchPageWithPinData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),m);function ai({pinKey:e}){let a=(0,j.TH)(),t=(0,w.Z)(an,e),n=(0,A.D)(),{getNormalizedPinImage:i}=(0,Z.Z)({pinKey:t,maxWidth:n?L.M:E.Wm}),{cropSource:l,entrypoint:r,full_feed_title:s="",filters:o,hybrid_search_param:d,journey_depth:u,search_query:c,source_module_id:p,selected_descriptors:g,requestParams:m,rs:h}=(0,M.mB)(a.search),{width:y,height:f}=i(),x=(0,_.useMemo)(()=>(0,I.Z)(a,y,f)??{x:0,y:0,w:y,h:f},[a,y,f]),v=(0,D.Z)(Number(l))||5,S=a.pathname.includes("/products"),{searchId:b,visualSearchFlashlightUnifiedResource:k,oneBarModules:P,descriptorModules:F}=(0,T.Z)({resourceOptions:{crop:(0,K.Z)({cropArea:x,scaledWidth:y,scaledHeight:f}),crop_source:v,entry_source:S?"shopping":"flashlight",entrypoint:r||S&&"feed_module"||null,field_set_key:"shopping_grid_item",image_signature:t.imageSignature||void 0,is_shopping:S,pin_id:t.entityId,request_params:m,source:h,filters:o,hybrid_search_param:d,selected_descriptors:g,journey_depth:parseInt(u,10)||void 0,search_query:c,source_module_id:p}});return t?(0,z.jsx)(n?at:eq,{cropArea:x,cropSource:v,descriptorModules:F,isProductPage:S,oneBarModules:P,pinKey:t,searchId:b,title:s,trafficSource:h,visualSearchFlashlightUnifiedResource:k}):null}function al({pinKey:e}){return(0,_.useEffect)(()=>{(0,f.Z)("VisualSearchPageWithPinData","/app/www/VisualSearch/VisualSearchPageWithPinData.tsx")},[]),(0,z.jsx)(A.h,{children:(0,z.jsx)(ai,{pinKey:e})})}let ar=(void 0!==h||(h=t(55575)).hash&&"0f7b98a1f02dbf8528df0452aa26efd4"!==h.hash&&console.error("The definition of 'RelatedProductsPageQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),h),as=(void 0!==y||(y=t(376985)).hash&&"91d05676e413b7b47653c2f8fa609093"!==y.hash&&console.error("The definition of 'RelatedProductsPage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),y);function ao({pinId:e,relatedProductsDataRef:a}){let t=(0,k.ZP)(),n=(0,b.Z)({strategy:"Legacy",query:ar,variables:{pinId:e},useGetLegacyData:()=>{let{data:e}=(0,P.Z)(a);return e}}),i=n?.v3GetPinQuery?.__typename==="V3GetPin"?n.v3GetPinQuery.data:null,l=(0,w.Z)(as,i);return(0,z.jsx)(_.Suspense,{fallback:(0,z.jsx)(v.xH,{accessibilityLabel:t._('Loading Pin data', 'RelatedProductsPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0}),children:l&&(0,z.jsx)(al,{pinKey:l})})}function ad(){(0,_.useEffect)(()=>{(0,f.Z)("RelatedProductsPage","/app/www/pages/authDesktop/RelatedProductsPage.tsx")},[]);let e=(0,x.$B)(),{pinId:a}=(0,C.Z)(e.params.id||""),{ref:t}=(0,F.Z)({name:"PinResource",options:{id:a,field_set_key:"detailed"}});return(0,z.jsx)(S.Z,{name:"RelatedProductsPage_RelatedProductsPageWrapper",children:(0,z.jsx)(_.Suspense,{fallback:(0,z.jsx)(R.Z,{}),children:(0,z.jsx)(ao,{pinId:a,relatedProductsDataRef:t})})})}},474147:function(e,a,t){t.d(a,{J:()=>h,Z:()=>x});var n=t(636208),i=t(35831),l=t(712064),r=t(356299),s=t(388023),o=t(428725),d=t(696323),u=t(339618);let c=new Set(["PinResource","RepinResource"]),p={ApiResource:e=>e?.url==="/v3/orientation/nux_creator_recommendations/"?"nux-creator-recommendations":e?.url==="/v3/users/me/interests/"?`recommended-interests:${e.data?.blend_type}`:e?.url===`/v3/usecases/${e.data?.use_case_id}/feed/`?"useCaseFeed":e?.url===`/v3/boards/${e.data?.board_id}/automagical/pins/`?`automagical-board-feed:${e.data?.board_id}`:"",AggregatedActivityFeedResource:e=>`trieditfeed:${e.aggregated_pin_data_id}`,AggregatedCommentFeedResource:e=>`aggregated-comments:${e.objectId}`,AggregatedCommentReplyFeedResource:e=>`${d.Z.AGGREGATED_COMMENT_REPLIES}:${e.objectId}`,BoardlessPinsResource:e=>`boardless-pins:${e.userId}`,BestPinsFeedAltResource:e=>`idea-page-best-pins:${e.interest}`,BoardArchiveResource:()=>"archived-boards",BoardContentRecommendationResource:e=>`recommendation-feed:${e.id}`,BoardFeedResource:e=>`boardfeed:${e.board_id}`,BoardSectionsRepinResource:e=>`board-sections:${e.board_id}`,BoardSectionsResource:e=>`board-sections:${e.board_id}`,BoardSectionPinsResource:e=>`board-section-pins:${e.section_id}`,BoardsFeedResource:e=>`profile-boards:${e.username}`,BoardToolsFeedResource:e=>`board-tools:${e.boardId}`,ConversationsResource:()=>"conversations",DidItLikedByResource:e=>`triedit-likes:${e.didItDataId}`,DidItUserFeedResource:e=>`profile-tried:${e.username}`,InterestResource:e=>`klp-pins:${e.interest}`,MoreIdeasTabsBoardsResource:()=>"homefeed-more-ideas-tabs",NewsHubResource:()=>"notifications",NewsHubDetailsResource:e=>`newshubdetail:${e.news_id}`,NuxInterestsResource:()=>"nuxTopics",PinsFromBrandResource:e=>`brand-pins:${e.pin}`,ReactionsResource:e=>`reactions:${e.pin_id}`,RelatedArticlesResource:e=>`related-articles:${e.article_id}`,RelatedModulesResource:e=>`related-modules:${e.pin_id}`,RelatedPinFeedResource:e=>`related-pins:${e.pin}`,RelatedStreamResource:e=>`related-story-pins:${e.pinId}`,SearchResource:e=>{let a=`search:${e.scope}:${e.query}:${e.filters||""}:${e.article||""}`;return e.auto_correction_disabled?`${a}:auto-correction-disabled`:a},BaseSearchResource:e=>{let{appliedProductFilters:a,article:t,auto_correction_disabled:n,filters:i,journey_depth:l,query:r,scope:s,selected_one_bar_modules:o,source_id:d,source_module_id:c,top_pin_ids:p}=e;return`search:${(0,u.Z)({appliedFilters:a,article:t,autoCorrectionDisabled:n,filters:i,journeyDepth:l,query:r,scope:s,selectedOneBarModules:o,sourceId:d,sourceModuleId:c,topPinIds:p})}`},SectionToolsFeedResource:e=>`section-tools:${e.sectionId}`,ShareSuggestionsTypeaheadResource:e=>`share-suggestions:${e.board||e.user}:${e.term}`,StoryFeedResource:e=>`story-feed:${e.feed_type}:${e.request_params}`,StoryPinTaggedProductsResource:()=>"story-pin-tagged-products",TodayArticleFeedResource:e=>`today-article:${e.id}`,TodayTabInterestFeedResource:e=>`today-article-interestfeed:${e.interest_id}`,TodayTabResource:()=>"today-tab",SeoTier1CandidateResource:()=>"tier1-feed",UnifiedCommentsResource:e=>`unified-comments:${e.aggregated_pin_id}`,UserActivityPinsResource:e=>`profile-pins-feed:${e.user_id}`,UserHomefeedResource:e=>e.pin_quiz?"pin-quiz":"homefeed",UserFollowingResource:e=>`user-following:${e.username}`,UserRecentActivityResource:e=>`user-recent-activity:${e.filter_type}`,UserStoryPinsFeedResource:e=>`story-pins-feed:${e.user_id}`,VisualLiveSearchResource:e=>`visual-search:${e.pin_id}:${e.crop.x}${e.crop.y}${e.crop.w}${e.crop.h}`,VisualLiveSearchProductFeedResource:e=>`visual-search-products:${e.pin_id}:${e.crop.x}${e.crop.y}${e.crop.w}${e.crop.h}`,VisualSearchFlashlightUnifiedResource:e=>`related-products-unified:${e.pin_id}`,InterestFollowingResource:e=>`topic-following:${e.username}`,UserPinsResource:e=>`profile-pins:${e.username}`,TopicFeedResource:e=>e.best_pins?`best-topic-pins:${e.interest}`:`topic-pins:${e.interest}`},g={AggregatedActivityFeedResource:({options:{aggregated_pin_data_id:e}})=>({type:d.Z.TRIED_IT_FEED,id:e}),AggregatedCommentFeedResource:({options:{objectId:e}})=>({type:d.Z.AGGREGATED_COMMENTS,id:e}),AggregatedCommentReplyFeedResource:({options:{isUnifiedComment:e,objectId:a}})=>({type:e?d.Z.AGGREGATED_COMMENT_REPLIES:d.Z.AGGREGATED_COMMENTS,id:a,reversed:!0}),ApiResource:({options:{url:e,data:a}})=>e===`/v3/usecases/${a?.use_case_id}/feed/`?{type:d.Z.USE_CASE_TAB,id:a.use_case_id}:e===`/v3/boards/${a?.board_id}/automagical/pins/`?{type:d.Z.AUTOMAGICAL_BOARD_FEED,id:a.board_id}:null,BoardFeedResource:({options:{board_id:e}})=>({type:d.Z.BOARDFEED,id:e}),BoardlessPinsResource:({options:{userId:e}})=>({type:d.Z.BOARDLESS_PINS,id:e}),BoardSectionPinsResource:({options:{section_id:e}})=>({type:d.Z.BOARD_SECTION_PINS,id:e}),BoardSectionsResource:({options:{board_id:e}})=>({type:d.Z.BOARD_SECTIONS,id:e}),BoardsResource:({options:{username:e,sort:a,filter_types:t}})=>({type:d.Z.PROFILE_BOARDS,id:(0,r.Z)(e,a,t)}),BaseSearchResource:({options:{appliedProductFilters:e,appliedUnifiedFilters:a,auto_correction_disabled:t,filters:n,journey_depth:i,query_pin_sigs:r,query:s,rs:o,scope:u,selected_one_bar_modules:c,source_id:p,source_module_id:g,top_pin_ids:m,user:h},response:y})=>({type:d.Z.SEARCH_PINS,id:(0,l.Tb)({appliedProductFilters:e,appliedUnifiedFilters:a,autoCorrectionDisabled:t,filters:n,journeyDepth:i,query:s,rs:o,scope:u,selectedOneBarModules:c,selectedPinImgSig:r,sourceId:p,sourceModuleId:g,topPinIds:m,user:h}),items:y.resource_response.data?.results||[]}),DidItCommentsResource:({options:{objectId:e}})=>({type:d.Z.AGGREGATED_COMMENTS,id:e,reversed:!0}),DidItUserFeedResource:({options:{username:e}})=>({type:d.Z.TRIED_IT_FEED,id:e}),RelatedArticlesResource:({options:{article_id:e}})=>({type:d.Z.TODAY_TAB,id:e}),StoryPinDraftsResource:({options:{userId:e}})=>({type:d.Z.STORY_PIN_DATA,id:e}),TodayTabInterestFeedResource:({options:{interest_id:e}})=>({type:d.Z.TODAY_ARTICLE_INTEREST_FEED,id:e}),TodayTabResource:()=>({type:d.Z.TODAY_TAB,id:"todayTab"}),UnifiedCommentsPreviewResource:({options:{aggregated_pin_id:e}})=>({type:d.Z.UNIFIED_COMMENTS,id:e}),UnifiedCommentsResource:({options:{aggregated_pin_id:e,is_reversed:a}})=>({type:d.Z.UNIFIED_COMMENTS,id:e,reversed:a}),UserActivityPinsResource:({options:{user_id:e}})=>({type:d.Z.PROFILE_PINS_FEED,id:e}),UserStoryPinsFeedResource:({response:e,options:{user_id:a}})=>({type:d.Z.STORY_PINS_FEED,id:a,items:e.resource_response.data||[]})},m=(e,{pinId:a,oldFeedId:t,newFeedId:n})=>t===n?e:((e,{pinId:a,feedId:t})=>e[t]?{...e,[t]:[{type:"pin",id:a},...e[t]]}:e)(((e,{pinId:a,feedId:t})=>e[t]?{...e,[t]:e[t].filter(e=>"pin"!==e.type||e.id!==a)}:e)(e,{pinId:a,feedId:t}),{pinId:a,feedId:n}),h=(e,a)=>e in p?p[e](a):null,y=(e,a)=>a?`board-section-pins:${a}`:`boardfeed:${e}`,f=(e,a)=>e.map(e=>{let{id:t,schema:n,type:i}=e;return"home_feed_tabs"===i?e:n?{id:t,type:n,trackingParams:"pin"===n?a.pins[t].tracking_params:void 0,user_id:void 0}:null}).filter(Boolean),_=(e,a,t)=>Object.keys(e).reduce((n,i)=>{let l=e[i]||[],r=l.filter(e=>{if(e.type!==a)return!0;if("reaction"===a){let a=e.id.lastIndexOf(":");return e.id.substring(0,a)!==t}return e.id!==t});return l.length!==r.length&&(n[i]=r),n},{...e}),x=(e={},a)=>{switch(a.type){case i.zP:case i.aW:{let{payload:t}=a,{resource:n,options:l,normalizedResponse:r,schema:u}=t;if(r&&n in p){let t=((e,a,t)=>{let n=t||s.Z[e];if(n===o.LR)return a.result;if(n===o.sN)return a.result.map(e=>({id:e,schema:"board"}));if(n===o.Gn)return a.result.map(e=>({id:e,schema:"user"}));if(n===o.Ht)return a.result.map(e=>({id:e,schema:"invite"}));if(n===o.fE)return a.result.map(e=>({id:e,schema:"reaction"}));if("object"==typeof n){let e=Object.entries(n).find(([,e])=>e===o.LR);if(e)return a.result[e[0]]}return null})(n,r,u);if(t&&Array.isArray(t)){let s=p[n](l);if("BoardToolsFeedResource"===n||"SectionToolsFeedResource"===n)return{...e,[s]:t};if("UnifiedCommentsResource"===n){let n=f(t,r.entities);if(e[s]&&(i.zP||i.aW===a.type))return{...e,[s]:[...e[s],...n]};return{...e,[s]:n}}{let n=[...a.type===i.aW&&e[s]||[],...f(t,r.entities)];return{...e,[s]:n}}}}else{let{data:n}=t.response.resource_response;if(!t.options?.redux_normalize_feed)return e;let l=g[t.resource]({options:t.options,response:t.response});if(l){let{type:t,id:r,items:s,reversed:o}=l,u=(s||n||[]).filter(Boolean).map(e=>((e,a)=>{switch(e.type){case"story":return{id:e.id??"",type:"story",story_type:e.story_type??""};case"module":return{id:e.id,type:"module",name:e.name};case"user":return{id:e.id,type:"user"};case"board":return a===d.Z.PROFILE_BOARDS?{id:e.id,type:"board",onProfile:!0,profileGroup:e.archived_by_me_at?"archived":e.privacy||"public"}:{id:e.id,type:"board",onProfile:!1};case"board_section":return{type:"boardsection",id:e.id};case"triedit":return{type:"triedit",id:e.id};case"aggregatedcomment":return{type:"aggregatedcomment",id:e.id};case"home_feed_tab":return{type:"home_feed_tab",id:e.id,name:e.name};case"storypindata":return{id:e.id,type:"storypindata"};case"todayarticle":return{type:"todayarticle",id:e.id};case"unifiedcommentspreview":return"userdiditdata"===e.unified_comment.type?{type:"triedit",id:e.unified_comment.id}:{type:"aggregatedcomment",id:e.unified_comment.id};default:let t="useCaseFeed"===a&&"tracking_params"in e;return{type:"pin",id:e.id??"",...t&&{trackingParams:e.tracking_params}}}})(e,t));o&&(u=u.reverse());let c=`${t}:${r}`,p=e[c];if(p||a.type!==i.aW){let t=p||[],n=u;return a.type===i.aW&&(n=o?u.concat(t):t.concat(u)),{...e,[c]:n}}}}break}case"FEED_ITEM_REORDERED":{let{payload:{feedType:t,feedId:i,itemType:l,targetItemId:r,sourceItemId:s}}=a,o=`${t}:${i}`,u=e[o]||[],c=-1,p=-1;if([d.Z.BOARDFEED,d.Z.BOARD_SECTION_PINS,d.Z.BOARD_SECTIONS,"profileBoards"].includes(t)&&(c=u.findIndex(e=>e.type===l&&e.id===s),p=u.findIndex(e=>e.type===l&&e.id===r)),-1!==c&&-1!==p)return{...e,[o]:(0,n.Z)(u,c,p)};break}case"FEED_ITEMS_REMOVED":{let{payload:{feedType:t,feedId:n,inverseSelection:i,itemType:l,itemIds:r=[]}}=a,s=`${t}:${n}`,o=e[s]||[];if(o&&o.length>0&&(t===d.Z.BOARD_SECTION_PINS||t===d.Z.BOARDFEED)){let a=o.filter(e=>{let a=r.includes(e.id);return!(e.type===l&&(i&&!a||!i&&a))}),t=!!a.find(e=>"pin"===e.type);return{...e,[s]:t?a:[]}}if(o&&o.length>0&&t===d.Z.BOARD_SECTIONS||o&&o.length>0&&(t===d.Z.AGGREGATED_COMMENTS||t===d.Z.BOARDLESS_PINS||t===d.Z.PROFILE_PINS_FEED||t===d.Z.STORY_PINS_FEED||t===d.Z.UNIFIED_COMMENTS||t===d.Z.TRIED_IT_FEED||t===d.Z.STORY_PIN_DATA)){let a=o.filter(e=>{let a=r.includes(e.id);return!(e.type===l&&a)});return{...e,[s]:a}}break}case"FEED_ITEMS_ADDED":{let{payload:{feedType:t,feedId:n,itemType:i,itemIds:l=[],prepend:r}}=a,s=`${t}:${n}`,o=e[s]||[];if(o&&(t===d.Z.BOARD_SECTION_PINS||t===d.Z.BOARDFEED||t===d.Z.BOARDLESS_PINS)){let a=l.map(e=>({id:e,type:i})),t=0;"story"===(o[0]||{}).type&&(t=1),"story"===(o[1]||{}).type&&(t=2);let n=[...o.slice(0,t),...a,...o.slice(t)];return{...e,[s]:n}}if(o&&t===d.Z.BOARD_SECTIONS){let a=[...l].reverse().map(e=>({id:e,type:"boardsection"})),t=o?[...a,...o]:[...a];return{...e,[s]:t}}if(t===d.Z.AGGREGATED_COMMENTS||t===d.Z.AGGREGATED_COMMENT_REPLIES||t===d.Z.PROFILE_PINS_FEED||t===d.Z.STORY_PINS_FEED||t===d.Z.UNIFIED_COMMENTS){let a=l.map(e=>({id:e,type:i})),t=o?[...r?a:o,...r?o:a]:a;return{...e,[s]:t}}if(t===d.Z.TRIED_IT_FEED){let a=l.map(e=>({id:e,type:i})),t=o?[...a,...o]:a;return{...e,[s]:t}}break}case"FEED_INVALIDATE":{let{payload:{feedType:t,feedId:n}}=a,i=`${t}:${n}`;return e[i],{...e,[i]:null}}case"APPEND_FEED_ITEMS":{let{payload:{id:t,items:n,options:i}}=a,l=e[t];if(!l)return{...e,[t]:n};{let a;return a=i.isPrepend?l[0]&&"story"===l[0].type?[].concat(l[0],n,l.slice(1)):n.concat(l):l.concat(n),{...e,[t]:a}}}case"PIN_DELETE":{let{payload:{pinId:t}}=a;return _(e,"pin",t)}case"BOARD_ARCHIVE":{let{payload:{boardId:t,username:n}}=a,i=`profile-boards:${n??""}`;if(e[i])return{...e,[i]:e[i].filter(e=>e.id!==t)};break}case"BOARD_UNARCHIVE":{let{payload:{boardId:t}}=a,n="archived-boards";if(e[n])return{...e,[n]:e[n].filter(e=>e.id!==t)};break}case"BOARD_DELETE":{let{payload:{boardId:t}}=a;return _(e,"board",t)}case"BOARD_SECTION_DELETE":{let{payload:{boardSectionId:t}}=a;return _(e,"boardsection",t)}case"PINS_MOVE":{let{payload:{source:t,target:n,pinIds:i,userId:l}}=a,r=t.boardlessPins&&l&&`boardless-pins:${l}`||t.boardId&&y(t.boardId,t.sectionId),s=y(n.boardId,n.sectionId);return i.reduce((e,a)=>m(e,{pinId:a,oldFeedId:r,newFeedId:s}),e)}case"PINS_MOVE_ALL":{let{payload:{source:t,target:n,excludePinIds:i}}=a,l=y(t.boardId,t.sectionId),r=y(n.boardId,n.sectionId),s={...e,[l]:i.map(e=>({type:"pin",id:e}))};return delete s[r],s}case"PIN_EDIT":{let{payload:{pinId:t,boardId:n,sectionId:i="",source:{boardId:l,sectionId:r}}}=a;return m(e,{pinId:t,oldFeedId:y(l,r),newFeedId:y(n,i)})}case i.AF:if(c.has(a.payload.resource)){let t,n=a.payload.response.resource_response.data,{board:i}=n;if("quick_saves"===i.layout)t=`boardless-pins:${a.payload.options.user_id}`;else{let e=a.payload.options.section;t=e?`board-section-pins:${e}`:`boardfeed:${i.id}`}if(e[t]){let a={...e},i={id:n.id,type:"pin",trackingParams:n?.tracking_params};return a[t]=[i].concat(e[t]),a}}if("BoardSectionResource"===a.payload.resource&&a.payload.normalizedResponse){let t=a.payload.normalizedResponse.result,n=a.payload.normalizedResponse.entities.boardsections[t].board,i=`board-sections:${n}`;if(e[i]){let a={...e};return a[i]=[{id:t,type:"boardsection"}].concat(e[i]),a}}if("AggregatedCommentResource"===a.payload.resource&&a.payload.normalizedResponse){let t={id:a.payload.normalizedResponse.result,type:"aggregatedcomment"},n={...e};for(let i of["aggregated-comments","unified-comments"]){let l=`${i}:${a.payload.options.objectId}`;e[l]&&(n={...n,[l]:[t].concat(n[l])})}return n}if("AggregatedCommentReplyResource"===a.payload.resource&&a.payload.normalizedResponse){let t=`${d.Z.AGGREGATED_COMMENT_REPLIES}:${a.payload.options.objectId}`;return{...e,[t]:[...e[t]||[],{id:a.payload.normalizedResponse.result,type:"aggregatedComment"}]}}if("ReactionsResource"===a.payload.resource&&a.payload.normalizedResponse){let{reaction_pin_id:t,reaction_type:n}=a.payload.options;if("reaction"===a.payload.options.action_type){let i=`reactions:${a.payload.options.pin_id}`,l={...e},r={id:`${t}:${a.payload.options.user_id}:${n}`,type:"reaction",trackingParams:void 0};return l[i]=[r].concat(e[i]),l}if("unreaction"===a.payload.options.action_type)return _(e,"reaction",`${t}:${a.payload.options.user_id}`)}break;case"COMPLETE_STORY":{let{payload:{storyId:t}}=a;return _(e,"story",t)}}return e}},588836:function(e,a,t){t.d(a,{Z:()=>x});var n=t(281098),i=t(667294),l=t(581722),r=t(825332),s=t(20256),o=t(111330),d=t(521009),u=t(346955),c=t(667835),p=t(19585),g=t(506662),m=t(753143),h=t(941404),y=t(572227),f=t(647709),_=t(785893);function x({alignIconLeft:e,bgColor:a,color:t,disableRedirect:x=!1,fallbackUrl:v,icon:S="arrow-back",onTouch:w,padding:b,placement:k,shouldUseFallbackUrl:P,size:F="lg",viewParameter:C,viewType:R,isVisualSearch:j}){(0,i.useEffect)(()=>{(0,n.Z)("BackButton","/app/www/routing/BackButton.tsx")},[]);let I=(0,p.ZP)(),T=(0,r.s0)(),E=(0,r.TH)(),Z=(0,f.HG)(),M=(0,l.v9)(e=>e.session.isAuthenticated),D=(0,d.Z)(),K=(0,y.Z)(),L=(0,c.vs)(),{viewType:A,viewParameter:$}=(0,u.SU)(),[O,B]=R?[R,C]:[A,$],N=()=>{let e=(0,m.M0)().getItem(o.pm);E.key||"/ideas"!==v?(0,h.My)(`pinner_conversion.back_button.${String(e?.[0].pageType)}`):(0,h.My)("pinner_conversion.back_button.no_history"),(0,h.My)(`web_back_button_click.${String(k)}.is_auth_${String(M)}`),K({action:"click",item:"back-button"}),O&&D({view_type:O,view_parameter:B,element:34,event_type:102}),w&&w(),x||((!E.key||!E.state||E.state?.referrer==="redirect"||P)&&v?T(v):E.pathname.includes("/password/reset/")&&E.search&&E.search.includes("?nativeShouldDismiss=true")?T("/login/?dismissWebview=true"):T(-1))},z=L?c.t4:"white",U=(0,g.am)(E)||j||"white"===t;return(0,_.jsx)(s.xu,{"data-test-id":"back-button",children:e?(0,_.jsx)(s.xu,{alignItems:"center",display:"flex",height:48,marginStart:"cancel"===S?-1:-2,width:48,children:(0,_.jsx)(s.hU,{accessibilityLabel:I._('Back', 'navigation button', 'navigation button'),bgColor:a,icon:S,iconColor:!t&&(!a||["white","lightGray","transparent"].includes(a))?"gray":t,onClick:N,padding:"auto"!==b?b:2,size:F})}):(0,_.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:Z||U||a?"":z,width:L&&!U?"fit-content":""}},rounding:"circle",children:(0,_.jsx)(s.hU,{accessibilityLabel:I._('Back', 'navigation button', 'navigation button'),bgColor:a||Z?a:"transparent",icon:S,iconColor:!t&&(!a||["white","lightGray","transparent"].includes(a))?"gray":t,onClick:N,padding:"auto"!==b?b:2,size:F})})})}},339618:function(e,a,t){t.d(a,{Z:()=>n});function n({appliedFilters:e,article:a,autoCorrectionDisabled:t,filters:n,journeyDepth:i,query:l,scope:r,selectedOneBarModules:s,sourceId:o,sourceModuleId:d,topPinIds:u}){let c=[r,l,n,e,a,o,d,i,u].map(e=>e??"").join(":");return t&&(c+=":auto-correction-disabled"),s&&(c+=`:${s}`),c}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/48137-f15d3b70ad96ac98.mjs.map